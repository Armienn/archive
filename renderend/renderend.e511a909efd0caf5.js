!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var s=e();for(var i in s)("object"==typeof exports?exports:t)[i]=s[i]}}(self,(()=>(()=>{"use strict";var t,e,s={"./libs/age/src/age.ts":(t,e,s)=>{s.r(e),s.d(e,{AgEngine:()=>i});class i{constructor(t,e,s){this.logics=t,this.validators=e,this.state=s}update(...t){return this.validate(t)||(this.performLogic(t),{isValid:!0,problems:[]})}validate(t){for(const e of this.validators){const s=e.validate(t);if(!s.isValid)return s}}performLogic(t){var e,s;this.state.tick++;for(const e of this.logics)e.update(t);null===(s=(e=this.state).finishUpdate)||void 0===s||s.call(e)}}},"./libs/age/src/base-display.ts":(t,e,s)=>{s.r(e)},"./libs/age/src/base-game.ts":(t,e,s)=>{s.r(e),s.d(e,{BaseGame:()=>i});class i{constructor(t=[],e=[]){this.logics=t,this.validators=e}update(...t){const e=this.validate(t);if(e)return e;for(const e of this.logics)e.update(t);return{isValid:!0,problems:[]}}validate(t){for(const e of this.validators){const s=e.validate(t);if(!s.isValid)return s}}}},"./libs/age/src/game-runner.ts":(t,e,s)=>{s.r(e),s.d(e,{GameRunner:()=>i});class i{constructor(t,e,s=30){this.display=t,this.game=e,this.updatesPerSecond=s,this.lastUpdate=Date.now(),this.stop=!1,this.actions=[],this.updateGame=()=>{this.game.update(...this.actions.splice(0),...this.display.getNewActions()),this.lastUpdate=Date.now()},this.startDisplayLoop=()=>{this.updateDisplay(),this.stop||requestAnimationFrame(this.startDisplayLoop)}}startGameLoop(){this.stopInterval(),this.timerId=window.setInterval(this.updateGame,1e3/this.updatesPerSecond)}stopInterval(){this.timerId&&window.clearInterval(this.timerId),this.timerId=null}updateDisplay(){const t=Date.now(),e=1e3/this.updatesPerSecond,s=(t-this.lastUpdate)/e;this.display.show(s)}onDestroy(){var t,e;this.stop=!0,window.clearInterval(this.timerId),null===(e=(t=this.display).onDestroy)||void 0===e||e.call(t)}}},"./libs/age/src/index.ts":(t,e,s)=>{s.r(e),s.d(e,{AgEngine:()=>i.AgEngine,BaseGame:()=>r.BaseGame,BaseValues:()=>h.BaseValues,Box:()=>f.Box,EntityManager:()=>c.EntityManager,GameGrid:()=>d.GameGrid,GameRunner:()=>a.GameRunner,Random:()=>o.Random,RandomAi:()=>n.RandomAi,RectangularSize:()=>y.RectangularSize,StandardValueGetter:()=>g.StandardValueGetter,TerrainManager:()=>u.TerrainManager,TypeMap:()=>p.TypeMap,ValueAccessBuilder:()=>g.ValueAccessBuilder,ValueAccessor:()=>g.ValueAccessor,ValueSetter:()=>g.ValueSetter,typeMask:()=>l.typeMask,typeOf:()=>l.typeOf,typeOffset:()=>l.typeOffset});var i=s("./libs/age/src/age.ts"),r=(s("./libs/age/src/base-display.ts"),s("./libs/age/src/base-game.ts")),a=s("./libs/age/src/game-runner.ts"),n=s("./libs/age/src/interfaces/game-ai.ts"),o=(s("./libs/age/src/interfaces/game-logic.ts"),s("./libs/age/src/interfaces/game-state.ts"),s("./libs/age/src/interfaces/game-validator.ts"),s("./libs/age/src/services/random.ts")),l=s("./libs/age/src/state/id.ts"),h=s("./libs/age/src/state/base-values.ts"),c=s("./libs/age/src/state/entity-manager.ts"),d=s("./libs/age/src/state/game-grid.ts"),u=s("./libs/age/src/state/terrain-manager.ts"),p=s("./libs/age/src/state/type-map.ts"),g=s("./libs/age/src/state/value-accessor.ts"),f=s("./libs/age/src/values/box.ts"),y=s("./libs/age/src/values/rectangular-size.ts")},"./libs/age/src/interfaces/game-ai.ts":(t,e,s)=>{s.r(e),s.d(e,{RandomAi:()=>i});class i{constructor(t){this.possibleActionsFor=t}requestActions(t){const e=this.possibleActionsFor(t);return[e[Math.floor(Math.random()*e.length)]]}}},"./libs/age/src/interfaces/game-logic.ts":(t,e,s)=>{s.r(e)},"./libs/age/src/interfaces/game-state.ts":(t,e,s)=>{s.r(e)},"./libs/age/src/interfaces/game-validator.ts":(t,e,s)=>{s.r(e)},"./libs/age/src/services/random.ts":(t,e,s)=>{s.r(e),s.d(e,{Random:()=>i});class i{constructor(t,e=-1,s=new r(-1)){this.getSeed=t,this.previousSeed=e,this.generator=s}get get(){const t=this.getSeed();return this.previousSeed===t||(this.previousSeed=t,this.generator=new r(t)),this.generator}}class r{constructor(t){this.seed=t}int(t){return Math.floor(Math.random()*t)}float(t){return Math.random()*t}in(t){return t[this.int(t.length)]}}},"./libs/age/src/state/base-values.ts":(t,e,s)=>{s.r(e),s.d(e,{BaseValues:()=>i});class i{constructor(t=new Map){this.entities=t,this.allValueMaps=[]}register(t){return this.allValueMaps.push(t),t}clear(){for(const t of this.allValueMaps)t.clear()}removeValuesFor(t){for(const e of this.allValueMaps)e.delete(t)}addValuesFromOther(t){for(let e=0;e<this.allValueMaps.length;e++)for(const[s,i]of t.allValueMaps[e])this.allValueMaps[e].set(s,i)}}},"./libs/age/src/state/entity-manager.ts":(t,e,s)=>{s.r(e),s.d(e,{EntityManager:()=>i});class i{constructor(t,e,s){this.entityValues=t,this.updatedEntityValues=e,this.idProvider=s,this.valueAccessors=[]}get with(){return this.entityValues}create(t){const e=this.idProvider.getNewId()|t;this.updatedEntityValues.entities.set(e,!0);for(const t of this.valueAccessors)t.initialiseValueFor(e);return e}remove(...t){for(const e of t)this.updatedEntityValues.entities.set(e,!1)}applyUpdatedValues(){this.entityValues.addValuesFromOther(this.updatedEntityValues),this.updatedEntityValues.clear();for(const[t,e]of this.updatedEntityValues.entities)e?this.add(t):this.fullyRemove(t);this.updatedEntityValues.entities.clear(),this.updatedEntityValues.entities.clear()}add(t){this.entityValues.entities.set(t,!0)}fullyRemove(t){this.entityValues.entities.delete(t),this.updatedEntityValues.entities.delete(t),this.entityValues.removeValuesFor(t),this.updatedEntityValues.removeValuesFor(t)}*[Symbol.iterator](){for(const[t]of this.entityValues.entities)yield t}}},"./libs/age/src/state/game-grid.ts":(t,e,s)=>{s.r(e),s.d(e,{GameGrid:()=>r});var i=s("./libs/utility/src/index.ts");class r{constructor(t,e,s=(()=>null)){this.width=t,this.height=e,this.setAll(s)}setAll(t){this.grid=[];for(const{x:e,y:s}of this.allFields())this.grid.push(t(e,s))}*allFields(){for(const t of(0,i.range)(0,this.height))for(const e of(0,i.range)(0,this.width))yield{x:e,y:t,field:this.get(e,t)}}*fieldsAround(t,e,s=1){for(const r of(0,i.range)(t-s,t+s+1))for(const t of(0,i.range)(e-s,e+s+1))this.isWithinBounds(r,t)&&(yield{i:r,j:t,field:this.get(r,t)})}get(t,e){return this.grid[this.indexFor(t,e)]}set(t,e,s){this.grid[this.indexFor(t,e)]=s}isWithinBounds(t,e){return 0<=t&&t<this.width&&0<=e&&e<this.height}indexFor(t,e){return t+e*this.width}}},"./libs/age/src/state/id.ts":(t,e,s)=>{s.r(e),s.d(e,{typeMask:()=>i,typeOf:()=>a,typeOffset:()=>r});const i=4278190080,r=24;function a(t){return t&i}},"./libs/age/src/state/terrain-manager.ts":(t,e,s)=>{s.r(e),s.d(e,{TerrainManager:()=>r});var i=s("./libs/utility/src/index.ts");class r{constructor(t={x:10,y:10,z:1},e,s=new Map){this.chunkSize=t,this.chunks=e,this.updatedBlocks=s}addChunk(t,e,s,i=0){this.chunks.set(this.convertChunkCoords(e,s,i),t)}get(t,e,s=0){t=Math.floor(t),e=Math.floor(e),s=Math.floor(s);const{chunkCoords:i,index:r}=this.getChunkPositionFor(t,e,s),a=this.chunks.get(i);return a||console.warn("Trying to access outside any chunk"),null==a?void 0:a[r]}getChunkPositionFor(t,e,s){const i=this.getChunkCoords(t,e,s);return{chunkCoords:this.convertChunkCoords(i.x,i.y,i.z),index:this.chunkIndexFor(t-i.x*this.chunkSize.x,e-i.y*this.chunkSize.y,s-i.z*this.chunkSize.z)}}getChunkCoords(t,e,s){return{x:this.chunkCoord(t,this.chunkSize.x),y:this.chunkCoord(e,this.chunkSize.y),z:this.chunkCoord(s,this.chunkSize.z)}}chunkCoord(t,e){return Math.floor(t/e)}convertChunkCoords(t,e,s){return t+","+e+","+s}chunkIndexFor(t,e,s){return t+e*this.chunkSize.x+s*this.chunkSize.x*this.chunkSize.y}getCurrent(t,e,s=0){var i;return t=Math.floor(t),e=Math.floor(e),s=Math.floor(s),null!==(i=this.updatedBlocks.get({x:t,y:e,z:s}))&&void 0!==i?i:this.get(t,e,s)}*allFields(t=0,e=0,s=0){const r=this.chunks.get(this.convertChunkCoords(t,e,s));for(const t of(0,i.range)(0,this.chunkSize.z))for(const e of(0,i.range)(0,this.chunkSize.y))for(const s of(0,i.range)(0,this.chunkSize.x))yield{x:s,y:e,z:t,field:r[this.chunkIndexFor(s,e,t)]}}fieldsAround(t,e,s=0){return this.fieldsWithinRadius(t,e,s,1,1,0)}*fieldsWithinRadius(t,e,s,r=1,a=1,n=1){for(const o of(0,i.range)(t-r,t+r+1))for(const t of(0,i.range)(e-a,e+a+1))for(const e of(0,i.range)(s-n,s+n+1))yield{i:o,j:t,k:e,field:this.get(o,t,e)}}set(t,e,s,i=0){e=Math.floor(e),s=Math.floor(s),i=Math.floor(i),this.updatedBlocks.set({x:e,y:s,z:i},t)}applyUpdatedValues(){for(const[{x:t,y:e,z:s},i]of this.updatedBlocks)this.setField(t,e,s,i);this.updatedBlocks.clear()}setField(t,e,s,i){const{chunkCoords:r,index:a}=this.getChunkPositionFor(t,e,s),n=this.chunks.get(r);n?n[a]=i:console.error("Can't set field outside chunks at ({0}, {1}, {2})",t,e,s)}}},"./libs/age/src/state/type-map.ts":(t,e,s)=>{s.r(e),s.d(e,{TypeMap:()=>r});var i=s("./libs/age/src/state/id.ts");class r{constructor(t=new Map){this.types=t}static from(t){const e=new r;for(const[s,r]of t.entries())e.types.set(r,s<<i.typeOffset);return e}typeFor(t){for(const[e,s]of this.types.entries())if(t===s)return e}typeIdFor(t){return this.types.get(t)}}},"./libs/age/src/state/value-accessor.ts":(t,e,s)=>{s.r(e),s.d(e,{StandardValueGetter:()=>a,ValueAccessBuilder:()=>o,ValueAccessor:()=>r,ValueSetter:()=>n});var i=s("./libs/age/src/state/id.ts");class r{constructor(t,e){this.get=t,this.set=e}initialiseValueFor(t){const e=this.get.defaultOf(t);null!=e&&this.set.for(t,e)}}class a{constructor(t,e,s,i,r){this.typeValues=t,this.entityValue=e,this.updatedEntityValue=s,this.getTypeValue=i,this.defaultValue=r}currentlyOf(t){var e;return null!==(e=this.updatedEntityValue.get(t))&&void 0!==e?e:this.of(t)}of(t){return this.entityValue.get(t)}defaultOf(t){var e;const s=(0,i.typeOf)(t);return null!==(e=this.getTypeValue(this.typeValues.get(s)))&&void 0!==e?e:this.defaultValue}}class n{constructor(t){this.updatedEntityValue=t}for(t,e){this.updatedEntityValue.set(t,e)}}class o{constructor(t,e,s){this.typeValues=t,this.entityValues=e,this.updatedEntityValues=s}for(t,e,s){return new r(new a(this.typeValues,t(this.entityValues),t(this.updatedEntityValues),e,s),new n(t(this.updatedEntityValues)))}}},"./libs/age/src/values/box.ts":(t,e,s)=>{s.r(e),s.d(e,{Box:()=>i});class i{constructor(t,e,s,i){this.minX=t,this.maxX=e,this.minY=s,this.maxY=i}static from(t,e){return new i(t.x-e.width/2,t.x+e.width/2,t.y-e.height/2,t.y+e.height/2)}translateBy(t){return new i(this.minX+t.x,this.maxX+t.x,this.minY+t.y,this.maxY+t.y)}contains(t){return this.minX<=t.x&&t.x<=this.maxX&&this.minY<=t.y&&t.y<=this.maxY}}},"./libs/age/src/values/rectangular-size.ts":(t,e,s)=>{s.r(e),s.d(e,{RectangularSize:()=>i});class i{constructor(t,e){this.width=t,this.height=e}}},"./libs/renderend/src/config/renderend-config.ts":(t,e,s)=>{s.r(e),s.d(e,{RenderendConfig:()=>n});var i=s("./libs/age/src/index.ts"),r=s("./libs/renderend/src/config/renderend-constants.ts"),a=s("./libs/utility/src/index.ts");class n{constructor(t,e,s){this.typeMap=t,this.typeValues=e,this.constants=s}static from(t,e){const s=Object.keys(e),a=i.TypeMap.from(s);return new n(a,new Map(s.map((t=>[a.typeIdFor(t),e[t]]))),new r.RenderendConstants(a.typeIdFor(t.shipType),a.typeIdFor(t.wallType),t.obstacleTypes.map((t=>a.typeIdFor(t)))))}static read(t){const e=Object.keys(t.types),s=i.TypeMap.from(e);return new n(s,new Map(e.map((e=>[s.typeIdFor(e),o(t.types[e],s)]))),new r.RenderendConstants(s.typeIdFor(t.constants.shipType),s.typeIdFor(t.constants.wallType),t.constants.obstacleTypes.map((t=>s.typeIdFor(t)))))}}function o(t,e){const s=Object.assign({},t);return t.position&&(s.position=Object.assign(new a.Vector2(0,0),t.position)),t.rectangularSize&&(s.rectangularSize=Object.assign(new i.RectangularSize(0,0),t.rectangularSize)),t.velocity&&(s.velocity=Object.assign(new a.Vector2(0,0),t.velocity)),t.bulletType&&(s.bulletType=e.typeIdFor(t.bulletType)),s}},"./libs/renderend/src/config/renderend-constants.ts":(t,e,s)=>{s.r(e),s.d(e,{RenderendConstants:()=>i});class i{constructor(t,e,s,i=.1,r=.05,a=.25,n=4,o=1/64){this.shipType=t,this.wallType=e,this.obstacleTypes=s,this.maxVerticalSpeed=i,this.minHorisontalSpeed=r,this.maxHorisontalSpeed=a,this.maxCharge=n,this.chargeSpeed=o}}},"./libs/renderend/src/display/display-config.ts":(t,e,s)=>{s.r(e),s.d(e,{readDisplayConfig:()=>r});var i=s("./libs/renderend/src/display/input-parser.ts");function r(t){const e=Object.assign({},t);e.inputs=new Map;for(const s in t.inputs)e.inputs.set(i.Input[s],t.inputs[s]);return e}},"./libs/renderend/src/display/display-entity-drawer.ts":(t,e,s)=>{s.r(e),s.d(e,{DisplayEntityDrawer:()=>a});var i=s("./libs/age/src/index.ts"),r=s("./libs/utility/src/index.ts");class a{constructor(t,e,s){this.game=t,this.state=e,this.spriteDrawer=s}drawDisplayEntities(){for(const t of this.state.displayEntities.values())this.drawDisplayEntity(t)}drawDisplayEntity(t){t.lastUpdate!==this.game.state.globals.tick&&t.velocity&&(t.position=t.position.add(t.velocity)),t.lastUpdate=this.game.state.globals.tick,this.game.state.globals.tick<t.endTick?this.spriteDrawer.draw(t.sprite,t.position,null,t.animationStart):this.state.displayEntities.remove(t)}onDeath(t){switch(this.game.config.typeMap.typeFor((0,i.typeOf)(t))){case"bullet":return this.spawnBulletExplosion(t);case"obstacle":return this.spawnObstacleExplosion(t);case"big-obstacle":return this.spawnBigObstacleExplosion(t)}}spawnObstacleExplosion(t){this.spawnExplosion("obstacle-explosion",this.game.entities.position.get.of(t),this.game.entities.velocity.get.of(t),40)}spawnBigObstacleExplosion(t){this.spawnExplosion("big-obstacle-explosion",this.game.entities.position.get.of(t),this.game.entities.velocity.get.of(t),40)}spawnBulletExplosion(t){this.spawnExplosion("bullet-explosion",this.game.entities.position.get.of(t),new r.Vector2(-this.game.state.globals.speed,0),20)}spawnExplosion(t,e,s,i){this.state.displayEntities.push({sprite:t,position:e,velocity:this.game.state.globals.isAlive?s:null,endTick:this.game.state.globals.tick+i,animationStart:this.game.state.globals.tick,lastUpdate:this.game.state.globals.tick})}}},"./libs/renderend/src/display/display-state.ts":(t,e,s)=>{s.r(e),s.d(e,{DisplayState:()=>i,ScreenSize:()=>r});class i{constructor(t,e=0,s=[]){this.size=t,this.fractionOfTick=e,this.displayEntities=s}static from(t){return new i(new r(t.renderToVirtualSize,t.virtualPixelsPerTile,100,100,t.virtualHeight,t.virtualHeight))}}class r{constructor(t,e,s,i,r,a){this.renderToVirtualSize=t,this.virtualPixelsPerTile=e,this.hostWidth=s,this.hostHeight=i,this.virtualWidth=r,this.virtualHeight=a}get hostPixelsPerTile(){return this.hostHeight/this.virtualHeight*this.virtualPixelsPerTile}get canvasWidth(){return this.renderToVirtualSize?this.virtualWidth:this.hostWidth}get canvasHeight(){return this.renderToVirtualSize?this.virtualHeight:this.hostHeight}get widthInTiles(){return this.virtualWidth/this.virtualPixelsPerTile}get heightInTiles(){return this.virtualHeight/this.virtualPixelsPerTile}updateHostSize(t,e){this.hostWidth=t,this.hostHeight=e,this.virtualWidth=this.hostWidth*(this.virtualHeight/this.hostHeight)}}},"./libs/renderend/src/display/entity-drawer.ts":(t,e,s)=>{s.r(e),s.d(e,{EntityDrawer:()=>r});var i=s("./libs/age/src/index.ts");class r{constructor(t,e){this.game=t,this.spriteDrawer=e}drawEntities(){for(const t of this.game.entities)this.drawEntity(t)}drawEntity(t){(0,i.typeOf)(t)===this.game.config.constants.shipType?this.drawShip(t):this.drawGeneralEntity(t)}drawGeneralEntity(t){const e=this.game.entities.position.get.of(t),s=this.game.entities.velocity.get.of(t),r=this.game.config.typeMap.typeFor((0,i.typeOf)(t));this.spriteDrawer.draw(r,e,s)}drawShip(t){const e=this.game.entities.position.get.of(t),s=this.game.entities.velocity.get.of(t),i=this.shieldSpriteFor(t);i&&this.spriteDrawer.draw(i,e,s),this.spriteDrawer.draw("ship",e,s);const r=this.chargeSpriteFor(t);r&&this.spriteDrawer.draw(r,e,s)}shieldSpriteFor(t){switch(this.game.entities.health.get.of(t)){case 3:return"full-shield";case 2:return"half-shield"}}chargeSpriteFor(t){var e;const s=null!==(e=this.game.entities.charge.get.of(t))&&void 0!==e?e:0;return 4<=s?"charge-4":3<=s?"charge-3":2<=s?"charge-2":1<=s?"charge-1":void 0}}},"./libs/renderend/src/display/input-parser.ts":(t,e,s)=>{s.r(e),s.d(e,{Input:()=>i,InputParser:()=>n});var i,r=s("./libs/utility/src/index.ts"),a=s("./libs/renderend/src/state/renderend-action.ts");class n{constructor(t,e,s=new Map,i=new Map){this.displayProvider=t,this.config=e,this.actionStates=s,this.previousStates=i}parseInputs(){return this.updateActionStates(),this.parseActions()}updateActionStates(){this.previousStates=this.actionStates,this.actionStates=new Map;for(const[t,e]of this.config.inputs)this.actionStates.set(t,this.stateFor(...e))}stateFor(...t){return t.map((t=>this.displayProvider.getInputState(t))).max()}parseActions(){return[this.parseMovement(),this.parseRestart(),this.parseShot()].filter((t=>t))}parseMovement(){var t,e,s,n;const o=this.boolStateFor(i.MoveSlow)?.5:1,l=null!==(t=this.actionStates.get(i.MoveUp))&&void 0!==t?t:0,h=null!==(e=this.actionStates.get(i.MoveDown))&&void 0!==e?e:0,c=null!==(s=this.actionStates.get(i.MoveLeft))&&void 0!==s?s:0,d=null!==(n=this.actionStates.get(i.MoveRight))&&void 0!==n?n:0,u=new r.Vector2(d-c,h-l).multiply(o);if(!u.isZero())return new a.MoveShipAction(u)}parseRestart(){if(this.boolStateFor(i.Restart))return new a.StartGameAction}parseShot(){if(this.hasJustBeenPressed(i.Shoot))return new a.ShootBulletAction}boolStateFor(t){return this.actionStates.get(t)>.5}hasJustBeenPressed(t){return this.actionStates.get(t)>.5&&this.previousStates.get(t)<=.5}}!function(t){t[t.Restart=0]="Restart",t[t.MoveUp=1]="MoveUp",t[t.MoveDown=2]="MoveDown",t[t.MoveLeft=3]="MoveLeft",t[t.MoveRight=4]="MoveRight",t[t.MoveSlow=5]="MoveSlow",t[t.Shoot=6]="Shoot"}(i||(i={}))},"./libs/renderend/src/display/sprite-drawer.ts":(t,e,s)=>{s.r(e),s.d(e,{SpriteDrawer:()=>i});class i{constructor(t,e,s,i){this.game=t,this.displayProvider=e,this.config=s,this.state=i}draw(t,e,s=null,i=0){var r,a;s&&(e=e.add(s.multiply(this.state.fractionOfTick)));const n=this.config.sprites[t];if(!n.frameInterval)return this.displayProvider.drawSprite(t,e.x,e.y,0,0);const o=null!==(r=n.framesX)&&void 0!==r?r:1,l=null!==(a=n.framesY)&&void 0!==a?a:1,h=o*l,c=this.game.state.globals.tick-i,d=Math.floor(c/n.frameInterval)%h,u=d%o,p=Math.floor(d/o)%l;this.displayProvider.drawSprite(t,e.x,e.y,u,p)}}},"./libs/renderend/src/logic/bullet-logic.ts":(t,e,s)=>{s.r(e),s.d(e,{BulletLogic:()=>a});var i=s("./libs/utility/src/index.ts"),r=s("./libs/renderend/src/state/renderend-action.ts");class a{constructor(t,e,s,i,r){this.entities=t,this.charge=e,this.position=s,this.setCharge=i,this.setPosition=r}update(t){if(t.some((t=>t instanceof r.ShootBulletAction)))for(const[t,e]of this.entities.with.bulletType)this.spawnBulletFor(t,e)}spawnBulletFor(t,e){var s;const r=this.charge.currentlyOf(t);if(r<1)return;const a=null!==(s=this.position.of(t))&&void 0!==s?s:new i.Vector2(0,0),n=this.entities.create(e);this.setPosition.for(n,a.add(new i.Vector2(.5,0))),r>0&&this.setCharge.for(t,r-1)}}},"./libs/renderend/src/logic/charge-logic.ts":(t,e,s)=>{s.r(e),s.d(e,{ChargeLogic:()=>i});class i{constructor(t,e,s){this.constants=t,this.entities=e,this.setCharge=s}update(){for(const[t,e]of this.entities.with.charge)this.chargeEntity(t,e)}chargeEntity(t,e){e<this.constants.maxCharge&&this.setCharge.for(t,e+this.constants.chargeSpeed)}}},"./libs/renderend/src/logic/collision-logic.ts":(t,e,s)=>{s.r(e),s.d(e,{CollisionLogic:()=>r});var i=s("./libs/age/src/index.ts");class r{constructor(t,e,s=[]){this.entities=t,this.position=e,this.listeners=s}update(){for(const[t,e]of this.entities.with.position)for(const[s,i]of this.entities.with.rectangularSize)this.collides(t,e,s,i)&&this.notify(t,s)}collides(t,e,s,r){if(t===s)return!1;const a=this.position.of(s);return!!a&&i.Box.from(a,r).contains(e)}notify(t,e){for(const s of this.listeners)s.onCollision(t,e),s.onCollision(e,t)}}},"./libs/renderend/src/logic/damage-logic.ts":(t,e,s)=>{s.r(e),s.d(e,{DamageLogic:()=>i});class i{constructor(t,e,s){this.damage=t,this.health=e,this.setHealth=s}onCollision(t,e){var s,i;const r=null!==(s=this.damage.of(t))&&void 0!==s?s:0;if(0===r)return;const a=null!==(i=this.health.of(e))&&void 0!==i?i:null;null===a||a<0||this.setHealth.for(e,a-r)}}},"./libs/renderend/src/logic/death-logic.ts":(t,e,s)=>{s.r(e),s.d(e,{DeathLogic:()=>i});class i{constructor(t,e,s=[]){this.entities=t,this.health=e,this.listeners=s}update(){for(const[t]of this.entities.with.health)this.health.currentlyOf(t)<=0&&this.kill(t)}kill(t){for(const e of this.listeners)e.onDeath(t);this.entities.remove(t)}}},"./libs/renderend/src/logic/despawn-logic.ts":(t,e,s)=>{s.r(e),s.d(e,{DespawnLogic:()=>i});class i{constructor(t){this.entities=t}update(){for(const[t,e]of this.entities.with.position)this.shouldDespawn(e)&&this.despawn(t)}shouldDespawn(t){return t.x<-5||40<t.x||t.y<-5||15<t.y}despawn(t){this.entities.remove(t)}}},"./libs/renderend/src/logic/difficulty-logic.ts":(t,e,s)=>{s.r(e),s.d(e,{DifficultyLogic:()=>i});class i{constructor(t){this.globals=t}update(){this.globals.isAlive&&(this.globals.speed+=1e-4)}}},"./libs/renderend/src/logic/game-over-logic.ts":(t,e,s)=>{s.r(e),s.d(e,{GameOverLogic:()=>i});class i{constructor(t,e){this.globals=t,this.shipBehaviour=e}onDeath(t){this.shipBehaviour.of(t)&&(this.globals.speed=0,this.globals.isAlive=!1)}}},"./libs/renderend/src/logic/move-ship-logic.ts":(t,e,s)=>{s.r(e),s.d(e,{MoveShipLogic:()=>a});var i=s("./libs/utility/src/index.ts"),r=s("./libs/renderend/src/state/renderend-action.ts");class a{constructor(t,e,s,i,r){this.constants=t,this.globals=e,this.entities=s,this.position=i,this.setVelocity=r}update(t){if(!this.globals.isAlive)return;this.globals.distanceTravelled+=this.globals.speed;const e=t.find((t=>t instanceof r.MoveShipAction));e?this.changeVelocity(e.velocity):this.changeVelocity(new i.Vector2(0,0))}changeVelocity(t){const e=t.lengthSquared()>1?t.unitVector().multiply(this.constants.maxVerticalSpeed):t.multiply(this.constants.maxVerticalSpeed);for(const[t]of this.entities.with.shipBehaviour){const s=this.position.of(t);s.x<1&&e.x<0&&e.set(0,e.y),s.x>10&&e.x>0&&e.set(0,e.y),this.setVelocity.for(t,e)}}}},"./libs/renderend/src/logic/obstacle-logic.ts":(t,e,s)=>{s.r(e),s.d(e,{ObstacleLogic:()=>r});var i=s("./libs/utility/src/index.ts");class r{constructor(t,e,s,i,r,a,n,o){this.constants=t,this.globals=e,this.entities=s,this.position=i,this.rectangularSize=r,this.setPosition=a,this.setVelocity=n,this.random=o}update(){for(const[t]of this.entities.with.obstacleBehaviour)this.updateSpeed(t);for(;this.shouldSpawnWalls();)this.spawnNextWallSegment();this.shouldSpawnObstacle()&&this.spawnObstacle(),this.shouldSpawnAnnoyingObstacle()&&this.spawnAnnoyingObstacle()}updateSpeed(t){this.setVelocity.for(t,new i.Vector2(-this.globals.speed,0))}shouldSpawnWalls(){return this.globals.lastWall<this.globals.distanceTravelled+20}spawnNextWallSegment(){this.globals.lastWall+=1;const t=this.globals.lastWall-this.globals.distanceTravelled;this.spawnWallsAt(t)}spawnWallsAt(t){const e=this.rectangularSize.defaultOf(this.constants.wallType);this.spawnWallAt(t,0,e),this.spawnWallAt(t,9,e),this.random.get.int(2)||(this.random.get.int(2)?this.spawnWallAt(t,1,e):this.spawnWallAt(t,8,e))}spawnWallAt(t,e,s){const r=this.entities.create(this.constants.wallType);this.setPosition.for(r,new i.Vector2(t+s.width/2,e+s.height/2)),this.setVelocity.for(r,new i.Vector2(-this.globals.speed,0))}shouldSpawnObstacle(){return!(!this.globals.isAlive||this.globals.lastWall<10||(this.globals.lastWall<100?this.globals.tick%40!=0:this.globals.lastWall<500?this.globals.tick%20!=0:this.globals.tick%15!=0))}spawnObstacle(){const t=this.random.get.in(this.constants.obstacleTypes),e=this.rectangularSize.defaultOf(t).height;this.spawnObstacleAt(t,this.random.get.float(2),1+this.random.get.float(7-e)+e)}shouldSpawnAnnoyingObstacle(){return this.globals.tick%205==0}spawnAnnoyingObstacle(){const t=this.random.get.in(this.constants.obstacleTypes);this.spawnObstacleAt(t,this.random.get.float(2),this.getShipHeight())}spawnObstacleAt(t,e,s){const r=this.globals.lastWall-this.globals.distanceTravelled,a=this.entities.create(t);this.setPosition.for(a,new i.Vector2(r+Math.floor(16*e)/16,s)),this.setVelocity.for(a,new i.Vector2(-this.globals.speed,0))}getShipHeight(){for(const[t]of this.entities.with.shipBehaviour)return this.position.of(t).y}}},"./libs/renderend/src/logic/start-logic.ts":(t,e,s)=>{s.r(e),s.d(e,{StartLogic:()=>a});var i=s("./libs/utility/src/index.ts"),r=s("./libs/renderend/src/state/renderend-action.ts");class a{constructor(t,e,s,i,r){this.constants=t,this.changes=e,this.globals=s,this.entities=i,this.setPosition=r}update(t){t.some((t=>t instanceof r.StartGameAction))&&this.initialiseGame()}initialiseGame(){this.clearMap(),this.resetGlobals(),this.spawnPlayerShip()}clearMap(){for(const[t,e]of this.changes.updatedEntityValues.entities)e&&this.entities.remove(t);this.entities.remove(...this.entities)}resetGlobals(){this.globals.isAlive=!0,this.globals.speed=.1,this.globals.distanceTravelled=0,this.globals.lastWall=-1}spawnPlayerShip(){const t=this.entities.create(this.constants.shipType);this.setPosition.for(t,new i.Vector2(1,5))}}},"./libs/renderend/src/logic/update-state-logic.ts":(t,e,s)=>{s.r(e),s.d(e,{UpdateStateLogic:()=>i});class i{constructor(t,e){this.state=t,this.entities=e}update(){this.state.globals.tick++,this.entities.applyUpdatedValues()}}},"./libs/renderend/src/logic/velocity-logic.ts":(t,e,s)=>{s.r(e),s.d(e,{VelocityLogic:()=>i});class i{constructor(t,e,s){this.entities=t,this.position=e,this.setPosition=s}update(){for(const[t,e]of this.entities.with.velocity)this.updateEntity(t,e)}updateEntity(t,e){if(e.isZero())return;const s=this.position.of(t);this.setPosition.for(t,s.add(e))}}},"./libs/renderend/src/renderend-display.ts":(t,e,s)=>{s.r(e),s.d(e,{RenderendDisplay:()=>h});var i=s("./libs/utility/src/index.ts"),r=s("./libs/renderend/src/display/display-entity-drawer.ts"),a=s("./libs/renderend/src/display/display-state.ts"),n=s("./libs/renderend/src/display/entity-drawer.ts"),o=s("./libs/renderend/src/display/input-parser.ts"),l=s("./libs/renderend/src/display/sprite-drawer.ts");class h{constructor(t,e,s,i=a.DisplayState.from(t),h=new o.InputParser(s,t),c=new l.SpriteDrawer(e,s,t,i),d=new n.EntityDrawer(e,c),u=new r.DisplayEntityDrawer(e,i,c)){this.config=t,this.game=e,this.display=s,this.state=i,this.inputParser=h,this.spriteDrawer=c,this.entityDrawer=d,this.displayEntityDrawer=u,this.game.deathLogic.listeners.push(u)}setSize(t,e){this.state.size.updateHostSize(t,e)}show(t=0){this.state.fractionOfTick=t,this.display.startFrame(),this.drawBackground(),this.entityDrawer.drawEntities(),this.displayEntityDrawer.drawDisplayEntities(),this.writeText(),this.display.endFrame()}drawBackground(){const t=450/this.state.size.virtualPixelsPerTile,e=this.backgroundBasePosition()%t;this.spriteDrawer.draw("background",new i.Vector2(e,0)),this.spriteDrawer.draw("background",new i.Vector2(e+t,0)),this.spriteDrawer.draw("background",new i.Vector2(e+2*t,0))}backgroundBasePosition(){return.5*-this.game.state.globals.distanceTravelled-.5*this.game.state.globals.speed*this.state.fractionOfTick}writeText(){const t=""+Math.floor(this.game.state.globals.distanceTravelled);this.display.drawString(t,this.state.size.widthInTiles/2,9,this.config.font,.5),this.game.state.globals.isAlive||this.display.drawString("GAME OVER",this.state.size.widthInTiles/2,4,this.config.font,1)}getNewActions(){return this.inputParser.parseInputs()}}},"./libs/renderend/src/renderend-game.ts":(t,e,s)=>{var i,r;s.r(e),s.d(e,{DisplayProvider:()=>m,RenderendGame:()=>y});var a=s("./libs/age/src/index.ts"),n=s("./libs/web-gl-display/src/index.ts"),o=s("./libs/renderend/src/display/display-config.ts"),l=s("./libs/renderend/src/display/display-state.ts"),h=s("./libs/renderend/src/renderend.ts"),c=s("./libs/renderend/src/renderend-display.ts"),d=s("./libs/renderend/src/state/renderend-action.ts"),u=s("./libs/utility/src/index.ts"),p=s("./libs/renderend/src/game-config.json"),g=s("./libs/renderend/src/display-config.json"),f=s("./libs/renderend/src/config/renderend-config.ts");class y extends a.GameRunner{constructor(t,e,s,i,r=60,a=new ResizeObserver((()=>this.setSize(t.clientWidth,t.clientHeight)))){super(e,i,r),this.renderendDisplay=e,this.displayProvider=s,this.resizeObserver=a,this.resizeObserver.observe(t),this.actions.push(new d.StartGameAction)}static createAt(t,e){e=Object.assign(Object.assign({},(0,o.readDisplayConfig)(i||(i=s.t(g,2)))),e);const a=new h.Renderend(f.RenderendConfig.read(r||(r=s.t(p,2)))),n=new m(t,e),l=new c.RenderendDisplay(e,a,n);return new y(t,l,n,a)}setSize(t,e){this.renderendDisplay.setSize(t,e),this.displayProvider.setSize(t,e)}onDestroy(){this.resizeObserver.disconnect()}}class m{constructor(t,e){this.hostElement=t,this.config=e,this.textElements={},this.keyStates=new u.KeyStates,this.size=new l.ScreenSize(e.renderToVirtualSize,e.virtualPixelsPerTile,100,100,e.virtualHeight,e.virtualHeight),this.initialiseCanvas(),this.initialiseDisplay()}initialiseCanvas(){this.hostElement.style.position="relative",this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.config.renderToVirtualSize&&(this.canvas.style.width="100%",this.canvas.style.imageRendering="pixelated"),this.hostElement.appendChild(this.canvas)}initialiseDisplay(){this.display=new n.WebGl2Display(this.canvas,this.config.virtualPixelsPerTile,this.config.virtualHeight,this.config.renderToVirtualSize);for(const[t,e]of Object.entries(this.config.sprites))this.display.addSprite(t,this.config.assetFolder+e.path+".png",e.width,e.height,e.centerX,e.centerY)}startFrame(){this.display.startFrame(),this.updateTextElements()}updateTextElements(){for(const t in this.textElements)"none"===this.textElements[t].style.display?this.removeElement(t):this.textElements[t].style.display="none"}removeElement(t){const e=this.textElements[t];this.hostElement.removeChild(e),delete this.textElements[t]}drawSprite(t,e,s,i,r){this.display.isLoading()||this.display.drawSprite(t,e,s,i,r)}endFrame(){this.display.endFrame()}drawString(t,e,s,i,r,a="white"){const n=this.getTextElement(e,s,i,a,r);n.innerText=t,n.style.display="block"}getTextElement(t,e,s,i,r){const a=t+","+e+s+i+r;return this.textElements[a]||(this.textElements[a]=this.createTextElement(t,e,s,i,r)),this.textElements[a]}createTextElement(t,e,s,i,r){const a=document.createElement("div");return a.style.position="absolute",a.style.fontFamily=`'${s}', Courier, monospace`,a.style.fontWeight="bold",a.style.display="none",a.style.backgroundColor="rgba(0,0,0,0.5)",a.style.textAlign="center",a.style.color=i,a.style.left=this.size.hostPixelsPerTile*(t-3)+"px",a.style.top=this.size.hostPixelsPerTile*e+"px",a.style.fontSize=this.size.hostPixelsPerTile*r+"px",a.style.width=6*this.size.hostPixelsPerTile+"px",a.style.lineHeight=this.size.hostPixelsPerTile*r*2+"px",this.hostElement.appendChild(a),a}getInputState(t){return t=this.translateInputString(t),this.keyStates.getInputState(t)}translateInputString(t){if(1===t.length)return"Key"+t;switch(t){case"Up":return"ArrowUp";case"Down":return"ArrowDown";case"Left":return"ArrowLeft";case"Right":return"ArrowRight";case"LeftShift":return"ShiftLeft"}return t}setSize(t,e){this.size.updateHostSize(t,e),this.canvas.width=this.size.canvasWidth,this.canvas.height=this.size.canvasHeight,this.initialiseDisplay()}}},"./libs/renderend/src/renderend.ts":(t,e,s)=>{s.r(e),s.d(e,{Renderend:()=>S});var i=s("./libs/age/src/index.ts"),r=s("./libs/renderend/src/logic/bullet-logic.ts"),a=s("./libs/renderend/src/logic/charge-logic.ts"),n=s("./libs/renderend/src/logic/collision-logic.ts"),o=s("./libs/renderend/src/logic/damage-logic.ts"),l=s("./libs/renderend/src/logic/death-logic.ts"),h=s("./libs/renderend/src/logic/despawn-logic.ts"),c=s("./libs/renderend/src/logic/difficulty-logic.ts"),d=s("./libs/renderend/src/logic/game-over-logic.ts"),u=s("./libs/renderend/src/logic/move-ship-logic.ts"),p=s("./libs/renderend/src/logic/obstacle-logic.ts"),g=s("./libs/renderend/src/logic/start-logic.ts"),f=s("./libs/renderend/src/logic/update-state-logic.ts"),y=s("./libs/renderend/src/logic/velocity-logic.ts"),m=s("./libs/renderend/src/state/entity-values.ts"),b=s("./libs/renderend/src/state/globals.ts"),v=s("./libs/renderend/src/state/renderend-changes.ts"),w=s("./libs/renderend/src/state/renderend-entities.ts"),x=s("./libs/renderend/src/state/renderend-state.ts");class S extends i.BaseGame{constructor(t,e=new x.RenderendState(new b.Globals,new m.EntityValues),s=new v.RenderendChanges(new m.EntityValues),S=new w.RenderendEntities(t.typeValues,e.entityValues,s.updatedEntityValues,e),P=new i.Random((()=>e.globals.seed+e.globals.tick)),E=new r.BulletLogic(S,S.charge.get,S.position.get,S.charge.set,S.position.set),T=new a.ChargeLogic(t.constants,S,S.charge.set),O=new n.CollisionLogic(S,S.position.get),A=new o.DamageLogic(S.damage.get,S.health.get,S.health.set),M=new l.DeathLogic(S,S.health.get),R=new h.DespawnLogic(S),V=new c.DifficultyLogic(e.globals),B=new d.GameOverLogic(e.globals,S.shipBehaviour.get),L=new u.MoveShipLogic(t.constants,e.globals,S,S.position.get,S.velocity.set),_=new p.ObstacleLogic(t.constants,e.globals,S,S.position.get,S.rectangularSize.get,S.position.set,S.velocity.set,P),D=new g.StartLogic(t.constants,s,e.globals,S,S.position.set),k=new f.UpdateStateLogic(e,S),F=new y.VelocityLogic(S,S.position.get,S.position.set)){super([V,L,T,E,O,R,_,F,M,D,k]),this.config=t,this.state=e,this.changes=s,this.entities=S,this.random=P,this.bulletLogic=E,this.chargeLogic=T,this.collisionLogic=O,this.damageLogic=A,this.deathLogic=M,this.despawnLogic=R,this.difficultyLogic=V,this.gameOverLogic=B,this.moveShipLogic=L,this.obstacleLogic=_,this.startLogic=D,this.updateStateLogic=k,this.velocityLogic=F,O.listeners.push(A),M.listeners.push(B)}}},"./libs/renderend/src/state/entity-values.ts":(t,e,s)=>{s.r(e),s.d(e,{EntityValues:()=>r});var i=s("./libs/age/src/index.ts");class r extends i.BaseValues{constructor(t=new Map,e=new Map,s=new Map,i=new Map,r=new Map,a=new Map,n=new Map,o=new Map,l=new Map,h=new Map,c=new Map,d=new Map){super(d),this.bulletType=t,this.charge=e,this.damage=s,this.health=i,this.orientation=r,this.position=a,this.rectangularSize=n,this.velocity=o,this.shipBehaviour=l,this.obstacleBehaviour=h,this.dieOnCollisionBehaviour=c,this.register(t),this.register(e),this.register(s),this.register(i),this.register(r),this.register(a),this.register(n),this.register(o),this.register(l),this.register(h),this.register(c)}static from(t){const e=new r;for(const[s,i]of t)e.addValuesFrom(s,i);return e}addValuesFrom(t,e){void 0!==e.bulletType&&this.bulletType.set(t,e.bulletType),void 0!==e.charge&&this.charge.set(t,e.charge),void 0!==e.damage&&this.damage.set(t,e.damage),void 0!==e.health&&this.health.set(t,e.health),void 0!==e.orientation&&this.orientation.set(t,e.orientation),void 0!==e.position&&this.position.set(t,e.position),void 0!==e.rectangularSize&&this.rectangularSize.set(t,e.rectangularSize),void 0!==e.velocity&&this.velocity.set(t,e.velocity),void 0!==e.shipBehaviour&&this.shipBehaviour.set(t,e.shipBehaviour),void 0!==e.obstacleBehaviour&&this.obstacleBehaviour.set(t,e.obstacleBehaviour),void 0!==e.dieOnCollisionBehaviour&&this.dieOnCollisionBehaviour.set(t,e.dieOnCollisionBehaviour)}groupFor(t){return{bulletType:this.bulletType.get(t),charge:this.charge.get(t),damage:this.damage.get(t),health:this.health.get(t),orientation:this.orientation.get(t),position:this.position.get(t),rectangularSize:this.rectangularSize.get(t),velocity:this.velocity.get(t),shipBehaviour:this.shipBehaviour.get(t),obstacleBehaviour:this.obstacleBehaviour.get(t),dieOnCollisionBehaviour:this.dieOnCollisionBehaviour.get(t)}}}},"./libs/renderend/src/state/globals.ts":(t,e,s)=>{s.r(e),s.d(e,{Globals:()=>i});class i{constructor(t=!0,e=.1,s=0,i=-1,r=0,a=1,n=1){this.isAlive=t,this.speed=e,this.distanceTravelled=s,this.lastWall=i,this.tick=r,this.nextId=a,this.seed=n}}},"./libs/renderend/src/state/renderend-action.ts":(t,e,s)=>{s.r(e),s.d(e,{MoveShipAction:()=>a,RenderendAction:()=>i,ShootBulletAction:()=>n,StartGameAction:()=>r});class i{}class r extends i{}class a extends i{constructor(t){super(),this.velocity=t}}class n extends i{}},"./libs/renderend/src/state/renderend-changes.ts":(t,e,s)=>{s.r(e),s.d(e,{RenderendChanges:()=>i});class i{constructor(t){this.updatedEntityValues=t}}},"./libs/renderend/src/state/renderend-entities.ts":(t,e,s)=>{s.r(e),s.d(e,{RenderendEntities:()=>r});var i=s("./libs/age/src/index.ts");class r extends i.EntityManager{constructor(t,e,s,r,a=new i.ValueAccessBuilder(t,e,s),n=a.for((t=>t.bulletType),(t=>t.bulletType)),o=a.for((t=>t.charge),(t=>t.charge)),l=a.for((t=>t.damage),(t=>t.damage)),h=a.for((t=>t.health),(t=>t.health)),c=a.for((t=>t.orientation),(t=>t.orientation),0),d=a.for((t=>t.position),(t=>t.position)),u=a.for((t=>t.rectangularSize),(t=>t.rectangularSize)),p=a.for((t=>t.velocity),(t=>t.velocity)),g=a.for((t=>t.shipBehaviour),(t=>t.shipBehaviour)),f=a.for((t=>t.obstacleBehaviour),(t=>t.obstacleBehaviour)),y=a.for((t=>t.dieOnCollisionBehaviour),(t=>t.dieOnCollisionBehaviour))){super(e,s,r),this.bulletType=n,this.charge=o,this.damage=l,this.health=h,this.orientation=c,this.position=d,this.rectangularSize=u,this.velocity=p,this.shipBehaviour=g,this.obstacleBehaviour=f,this.dieOnCollisionBehaviour=y,this.valueAccessors.push(n,o,l,h,c,d,u,p,g,f,y)}}},"./libs/renderend/src/state/renderend-state.ts":(t,e,s)=>{s.r(e),s.d(e,{RenderendState:()=>i});class i{constructor(t,e){this.globals=t,this.entityValues=e}getNewId(){return this.globals.nextId++}}},"./libs/utility/src/array-extensions.ts":(t,e,s)=>{s.r(e),Object.defineProperty(Array.prototype,"sum",{value:function(){return this.reduce(((t,e)=>t+ +e),0)}}),Object.defineProperty(Array.prototype,"max",{value:function(){if(!this.length)throw new Error("Cannot find the max value in an empty array");return this.reduce(((t,e)=>t>e?t:e))}}),Object.defineProperty(Array.prototype,"min",{value:function(){if(!this.length)throw new Error("Cannot find the min value in an empty array");return this.reduce(((t,e)=>t<e?t:e))}}),Object.defineProperty(Array.prototype,"clear",{value:function(){return this.splice(0,this.length)}}),Object.defineProperty(Array.prototype,"first",{value:function(){return this[0]}}),Object.defineProperty(Array.prototype,"last",{value:function(){return this[this.length-1]}}),Object.defineProperty(Array.prototype,"distinct",{value:function(){return this.filter(((t,e)=>this.indexOf(t)===e))}}),Object.defineProperty(Array.prototype,"distinctBy",{value:function(t){return this.filter(((e,s)=>{const i=t(e);return this.findIndex((e=>t(e)===i))===s}))}}),Object.defineProperty(Array.prototype,"sortBy",{value:function(t,e=!0){return this.sort(((s,i)=>{let r=t(s);"string"==typeof r&&(r=r.toLowerCase());let a=t(i);return"string"==typeof a&&(a=a.toLowerCase()),r>a?e?1:-1:r<a?e?-1:1:0}))}}),Object.defineProperty(Array.prototype,"includesAny",{value:function(t){return this.some((e=>t.includes(e)))}}),Object.defineProperty(Array.prototype,"groupBy",{value:function(t){const e=[];for(const s of this){const i=t(s);let r=e.find((t=>t.group===i));r||(r={group:i,entries:[]},e.push(r)),r.entries.push(s)}return e}}),Object.defineProperty(Array.prototype,"remove",{value:function(t){const e=this.indexOf(t);return e>=0&&(this.splice(e,1),!0)}}),Object.defineProperty(Array.prototype,"findAndRemove",{value:function(t){const e=this.findIndex(t);return e>=0&&(this.splice(e,1),!0)}}),Object.defineProperty(Array.prototype,"removeBy",{value:function(t){const e=[];for(let s=0;s<this.length;s++)t(this[s])&&(e.push(...this.splice(s,1)),s--);return e}})},"./libs/utility/src/index.ts":(t,e,s)=>{s.r(e),s.d(e,{KeyStates:()=>i.KeyStates,Vector2:()=>a.Vector2,clip:()=>r.clip,hexEastOf:()=>r.hexEastOf,hexNorthEastOf:()=>r.hexNorthEastOf,hexNorthWestOf:()=>r.hexNorthWestOf,hexSouthEastOf:()=>r.hexSouthEastOf,hexSouthWestOf:()=>r.hexSouthWestOf,hexWestOf:()=>r.hexWestOf,hexesAdjacentTo:()=>r.hexesAdjacentTo,randomInt:()=>r.randomInt,randomIntBelow:()=>r.randomIntBelow,randomNumber:()=>r.randomNumber,randomNumberBelow:()=>r.randomNumberBelow,range:()=>r.range}),s("./libs/utility/src/array-extensions.ts");var i=s("./libs/utility/src/key-states.ts"),r=s("./libs/utility/src/utility.ts"),a=s("./libs/utility/src/vector2.ts");s("./libs/utility/src/vector3.ts")},"./libs/utility/src/key-states.ts":(t,e,s)=>{s.r(e),s.d(e,{KeyStates:()=>i});class i{constructor(t={},e={},s={}){this.onDown=t,this.onUp=e,this.states=s,this.onKeyDown=t=>{var e,s;this.states[t.code]||(this.states[t.code]=1,null===(s=(e=this.onDown)[t.code])||void 0===s||s.call(e,t.code))},this.onKeyUp=t=>{var e,s;this.states[t.code]&&(this.states[t.code]=0,null===(s=(e=this.onUp)[t.code])||void 0===s||s.call(e,t.code))},window.addEventListener("keydown",this.onKeyDown,{capture:!0}),window.addEventListener("keyup",this.onKeyUp)}onDestroy(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)}getInputState(t){const e=this.states[t];return null!=e?e:this.getFirstGamepadState(t)}getFirstGamepadState(t){var e,s;const i=(null!==(s=null===(e=navigator.getGamepads)||void 0===e?void 0:e.call(navigator))&&void 0!==s?s:[]).filter((t=>t));if(0===i.length)return 0;const r=i.first();return"standard"===(null==r?void 0:r.mapping)?this.getStandardGamepadState(t,r):this.getNonStandardGamepadState(t,r)}getStandardGamepadState(t,e){var s;return null!==(s=this.getStandardButtonState(t,e))&&void 0!==s?s:this.getStandardAnalogStickState(t,e)}getStandardButtonState(t,e){switch(t){case"PadA":return e.buttons[0].pressed?1:0;case"PadB":return e.buttons[1].pressed?1:0;case"PadX":return e.buttons[2].pressed?1:0;case"PadY":return e.buttons[3].pressed?1:0;case"PadLeftShoulder":return e.buttons[4].pressed?1:0;case"PadRightShoulder":return e.buttons[5].pressed?1:0;case"PadSelect":return e.buttons[8].pressed?1:0;case"PadStart":return e.buttons[9].pressed?1:0;case"PadUp":return e.buttons[12].pressed?1:0;case"PadDown":return e.buttons[13].pressed?1:0;case"PadLeft":return e.buttons[14].pressed?1:0;case"PadRight":return e.buttons[15].pressed?1:0}}getStandardAnalogStickState(t,e){switch(t){case"PadLeftStickUp":return 1.2*Math.max(0,-e.axes[1])-.2;case"PadLeftStickDown":return 1.2*Math.max(0,e.axes[1])-.2;case"PadLeftStickLeft":return 1.2*Math.max(0,-e.axes[0])-.2;case"PadLeftStickRight":return 1.2*Math.max(0,e.axes[0])-.2}}getNonStandardGamepadState(t,e){var s,i;return null!==(i=null!==(s=this.getNonStandardDpadState(t,e))&&void 0!==s?s:this.getStandardButtonState(t,e))&&void 0!==i?i:this.getNonStandardEmulatedLeftAnalogState(t,e)}getNonStandardDpadState(t,e){switch(t){case"PadUp":return e.axes[9]<-.7||.8<e.axes[9]&&e.axes[9]<1.1?1:0;case"PadDown":return-.2<e.axes[9]&&e.axes[9]<.5?1:0;case"PadLeft":return.4<e.axes[9]&&e.axes[9]<1.1?1:0;case"PadRight":return-.8<e.axes[9]&&e.axes[9]<0?1:0}}getNonStandardEmulatedLeftAnalogState(t,e){switch(t){case"PadLeftStickUp":return e.axes[9]<-.7||.8<e.axes[9]&&e.axes[9]<1.1?1:0;case"PadLeftStickDown":return-.2<e.axes[9]&&e.axes[9]<.5?1:0;case"PadLeftStickLeft":return.4<e.axes[9]&&e.axes[9]<1.1?1:0;case"PadLeftStickRight":return-.8<e.axes[9]&&e.axes[9]<0?1:0}}}},"./libs/utility/src/utility.ts":(t,e,s)=>{function*i(t,e){for(let s=t;s<e;s++)yield s}function r(t,e,s,i=!1){if(s<=e)throw"Error";if(!i)return t<e?t=e:s<=t&&(t=s),t;for(;t<e;)t+=s-e;for(;s<=t;)t-=s-e;return t}function a(t,e){return[n(t,e),o(t,e),l(t,e),h(t,e),c(t,e),d(t,e)]}function n(t,e,s=1){const i=(e+s)%2==0?-1:0;return{x:t-Math.floor(s/2)+i,y:e-s}}function o(t,e,s=1){const i=(e+s)%2==0?0:1;return{x:t+Math.floor(s/2)+i,y:e-s}}function l(t,e,s=1){return{x:t-s,y:e}}function h(t,e,s=1){return{x:t+s,y:e}}function c(t,e,s=1){const i=(e+s)%2==0?-1:0;return{x:t-Math.floor(s/2)+i,y:e+s}}function d(t,e,s=1){const i=(e+s)%2==0?0:1;return{x:t+Math.floor(s/2)+i,y:e+s}}function u(t,e){return Math.floor(Math.random()*(e-t)+t)}function p(t){return Math.floor(Math.random()*t)}function g(t,e){return Math.random()*(e-t)+t}function f(t){return Math.random()*t}s.r(e),s.d(e,{clip:()=>r,hexEastOf:()=>h,hexNorthEastOf:()=>o,hexNorthWestOf:()=>n,hexSouthEastOf:()=>d,hexSouthWestOf:()=>c,hexWestOf:()=>l,hexesAdjacentTo:()=>a,randomInt:()=>u,randomIntBelow:()=>p,randomNumber:()=>g,randomNumberBelow:()=>f,range:()=>i})},"./libs/utility/src/vector2.ts":(t,e,s)=>{s.r(e),s.d(e,{Vector2:()=>r});var i=s("./libs/utility/src/utility.ts");class r{constructor(t,e){this.x=t,this.y=e}static fromAngle(t){return new r(1,0).rotate(t)}add(t){return new r(this.x+t.x,this.y+t.y)}subtract(t){return new r(this.x-t.x,this.y-t.y)}multiply(t){return new r(this.x*t,this.y*t)}rotate(t){return new r(this.x*Math.cos(t)-this.y*Math.sin(t),this.x*Math.sin(t)+this.y*Math.cos(t))}angle(){return Math.atan2(this.y,this.x)}lengthSquared(){return this.x*this.x+this.y*this.y}unitVector(){const t=this.length();return 0===t?new r(0,0):new r(this.x/t,this.y/t)}length(){return 0===this.x||0===this.y?this.x+this.y:Math.sqrt(this.lengthSquared())}copy(){return new r(this.x,this.y)}clip(t,e,s,a,n=!1){return new r((0,i.clip)(this.x,t,s,n),(0,i.clip)(this.y,e,a,n))}set(t,e){this.x=t,this.y=e}isZero(){return 0===this.x&&0===this.y}}},"./libs/utility/src/vector3.ts":(t,e,s)=>{s.r(e)},"./libs/web-gl-display/src/generic-shader.ts":(t,e,s)=>{s.r(e),s.d(e,{GenericShader:()=>i});class i{constructor(t,e,s){this.gl=t;const i=this.getShader(e,t.VERTEX_SHADER),r=this.getShader(s,t.FRAGMENT_SHADER);this.program=this.createProgram(i,r),t.deleteShader(i),t.deleteShader(r)}getShader(t,e){const s=this.gl.createShader(e);if(this.gl.shaderSource(s,t),this.gl.compileShader(s),!this.gl.getShaderParameter(s,this.gl.COMPILE_STATUS))throw new Error("Shader error: "+this.gl.getShaderInfoLog(s));return s}createProgram(t,e){const s=this.gl.createProgram();if(this.gl.attachShader(s,t),this.gl.attachShader(s,e),this.gl.linkProgram(s),!this.gl.getProgramParameter(s,this.gl.LINK_STATUS))throw new Error("Shader program error: "+this.gl.getProgramInfoLog(s));return this.gl.detachShader(s,t),this.gl.detachShader(s,e),this.gl.useProgram(null),s}}},"./libs/web-gl-display/src/index.ts":(t,e,s)=>{s.r(e),s.d(e,{WebGl2Display:()=>i.WebGl2Display});var i=s("./libs/web-gl-display/src/web-gl-display.ts")},"./libs/web-gl-display/src/m3x3.ts":(t,e,s)=>{s.r(e),s.d(e,{M3x3:()=>i});class i{constructor(t=[1,0,0,0,1,0,0,0,1]){this.matrix=t}multiply(t){const e=new i;return e.matrix=[this.matrix[0]*t.matrix[0]+this.matrix[3]*t.matrix[1]+this.matrix[6]*t.matrix[2],this.matrix[1]*t.matrix[0]+this.matrix[4]*t.matrix[1]+this.matrix[7]*t.matrix[2],this.matrix[2]*t.matrix[0]+this.matrix[5]*t.matrix[1]+this.matrix[8]*t.matrix[2],this.matrix[0]*t.matrix[3]+this.matrix[3]*t.matrix[4]+this.matrix[6]*t.matrix[5],this.matrix[1]*t.matrix[3]+this.matrix[4]*t.matrix[4]+this.matrix[7]*t.matrix[5],this.matrix[2]*t.matrix[3]+this.matrix[5]*t.matrix[4]+this.matrix[8]*t.matrix[5],this.matrix[0]*t.matrix[6]+this.matrix[3]*t.matrix[7]+this.matrix[6]*t.matrix[8],this.matrix[1]*t.matrix[6]+this.matrix[4]*t.matrix[7]+this.matrix[7]*t.matrix[8],this.matrix[2]*t.matrix[6]+this.matrix[5]*t.matrix[7]+this.matrix[8]*t.matrix[8]],e}transition(t,e){const s=new i;return s.matrix=[this.matrix[0],this.matrix[1],this.matrix[2],this.matrix[3],this.matrix[4],this.matrix[5],t*this.matrix[0]+e*this.matrix[3]+this.matrix[6],t*this.matrix[1]+e*this.matrix[4]+this.matrix[7],t*this.matrix[2]+e*this.matrix[5]+this.matrix[8]],s}scale(t,e){const s=new i;return s.matrix=[this.matrix[0]*t,this.matrix[1]*t,this.matrix[2]*t,this.matrix[3]*e,this.matrix[4]*e,this.matrix[5]*e,this.matrix[6],this.matrix[7],this.matrix[8]],s}getFloatArray(){return new Float32Array(this.matrix)}}},"./libs/web-gl-display/src/sprite-factory.ts":(t,e,s)=>{s.r(e),s.d(e,{SpriteFactory:()=>a});var i=s("./node_modules/tslib/tslib.es6.js"),r=s("./libs/web-gl-display/src/sprite.ts");class a{constructor(t,e,s,i){this.gl=t,this.shader=e,this.tileSize=s,this.worldSpaceMatrix=i}createSprite(t,e,s,a,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.loadImage(t),o=e/i.width,l=s/i.height;this.gl.useProgram(this.shader.program);const h=this.createTexture(i),c=this.createTextureBuffer(o,l),d=this.createGeometryBuffer(e,s);return this.gl.useProgram(null),new r.Sprite(this.gl,this.shader,this.tileSize,this.worldSpaceMatrix,h,c,d,a,n,o,l)}))}loadImage(t){return new Promise((e=>{const s=new Image;s.onload=()=>e(s),s.src=t}))}createTexture(t){const e=this.gl,s=e.createTexture();return e.bindTexture(e.TEXTURE_2D,s),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.MIRRORED_REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.MIRRORED_REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.bindTexture(e.TEXTURE_2D,null),s}createTextureBuffer(t,e){const s=this.gl,i=s.createBuffer();return s.bindBuffer(s.ARRAY_BUFFER,i),s.bufferData(s.ARRAY_BUFFER,this.createRectArray(0,0,t,e),s.STATIC_DRAW),i}createGeometryBuffer(t,e){const s=this.gl,i=s.createBuffer();return s.bindBuffer(s.ARRAY_BUFFER,i),s.bufferData(s.ARRAY_BUFFER,this.createRectArray(0,0,t,e),s.STATIC_DRAW),i}createRectArray(t=0,e=0,s=1,i=1){return new Float32Array([t,e,t+s,e,t,e+i,t,e+i,t+s,e,t+s,e+i])}}},"./libs/web-gl-display/src/sprite.ts":(t,e,s)=>{s.r(e),s.d(e,{Sprite:()=>r});var i=s("./libs/web-gl-display/src/m3x3.ts");class r{constructor(t,e,s,i,r,a,n,o,l,h,c){this.gl=t,this.shader=e,this.tileSize=s,this.worldSpaceMatrix=i,this.texture=r,this.textureBuffer=a,this.geometryBuffer=n,this.centerX=o,this.centerY=l,this.uvX=h,this.uvY=c}render(t,e,s=0,r=0){const a=this.gl;a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,this.texture),a.uniform1i(this.shader.uImageLocation,0),a.bindBuffer(a.ARRAY_BUFFER,this.textureBuffer),a.enableVertexAttribArray(this.shader.aTexCoordLocation),a.vertexAttribPointer(this.shader.aTexCoordLocation,2,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,this.geometryBuffer),a.enableVertexAttribArray(this.shader.aPositionLocation),a.vertexAttribPointer(this.shader.aPositionLocation,2,a.FLOAT,!1,0,0);const n=s*this.uvX,o=r*this.uvY,l=(new i.M3x3).transition(t*this.tileSize-this.centerX,e*this.tileSize-this.centerY);a.uniform2f(this.shader.uFrameLocation,n,o),a.uniformMatrix3fv(this.shader.uWorldLocation,!1,this.worldSpaceMatrix.getFloatArray()),a.uniformMatrix3fv(this.shader.uObjectLocation,!1,l.getFloatArray()),a.drawArrays(a.TRIANGLE_STRIP,0,6)}}},"./libs/web-gl-display/src/standard-shader.ts":(t,e,s)=>{s.r(e),s.d(e,{StandardShader:()=>r});var i=s("./libs/web-gl-display/src/generic-shader.ts");class r extends i.GenericShader{constructor(t,e,s,i,r,a,n){super(t,"\nattribute vec2 aPosition;\nattribute vec2 aTexCoord;\nvarying vec2 vTexCoord;\nuniform mat3 uWorld;\nuniform mat3 uObject;\nuniform vec2 uFrame;\nvoid main(void) {\ngl_Position = vec4(uWorld * uObject * vec3(aPosition, 1), 1);\nvTexCoord = aTexCoord + uFrame;\n}","\nprecision mediump float;\nuniform sampler2D uImage;\nvarying vec2 vTexCoord;\nvoid main(void) {\ngl_FragColor = texture2D(uImage, vTexCoord);\n}"),this.aPositionLocation=e,this.aTexCoordLocation=s,this.uImageLocation=i,this.uWorldLocation=r,this.uObjectLocation=a,this.uFrameLocation=n,this.aPositionLocation=t.getAttribLocation(this.program,"aPosition"),this.aTexCoordLocation=t.getAttribLocation(this.program,"aTexCoord"),this.uImageLocation=t.getUniformLocation(this.program,"uImage"),this.uWorldLocation=t.getUniformLocation(this.program,"uWorld"),this.uObjectLocation=t.getUniformLocation(this.program,"uObject"),this.uFrameLocation=t.getUniformLocation(this.program,"uFrame")}}},"./libs/web-gl-display/src/web-gl-display.ts":(t,e,s)=>{s.r(e),s.d(e,{WebGl2Display:()=>o});var i=s("./node_modules/tslib/tslib.es6.js"),r=s("./libs/web-gl-display/src/m3x3.ts"),a=s("./libs/web-gl-display/src/sprite-factory.ts"),n=s("./libs/web-gl-display/src/standard-shader.ts");class o{constructor(t,e,s,i=!1,r=t.getContext("webgl2"),o=new n.StandardShader(r),h=null,c=l(t.width,t.height,s),d=new a.SpriteFactory(r,o,e,c),u={},p=[]){this.canvas=t,this.tileSize=e,this.virtualScreenHeight=s,this.alignToPixelGrid=i,this.gl=r,this.standardShader=o,this.previousProgram=h,this.worldSpaceMatrix=c,this.spriteFactory=d,this.sprites=u,this.loadingSprites=p,this.gl.enable(this.gl.BLEND)}startFrame(){this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)}drawSprite(t,e,s,i,r){const a=this.sprites[t];if(!a)return console.warn("Could not load sprite {0}",t);this.previousProgram!=a.shader.program&&(this.gl.useProgram(a.shader.program),this.previousProgram=a.shader.program),this.alignToPixelGrid&&(e=Math.floor(e*this.tileSize)/this.tileSize,s=Math.floor(s*this.tileSize)/this.tileSize),a.render(e,s,i,r)}endFrame(){this.previousProgram=null,this.gl.useProgram(null),this.gl.flush()}resize(t,e){this.canvas.width=t,this.canvas.height=e,this.worldSpaceMatrix=l(t,e,this.virtualScreenHeight),this.spriteFactory=new a.SpriteFactory(this.gl,this.standardShader,this.tileSize,this.worldSpaceMatrix)}addSprite(t,e,s=16,r=16,a=0,n=0){return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.loadingSprites.push(t),this.sprites[t]=yield this.spriteFactory.createSprite(e,s,r,a,n),this.loadingSprites.splice(this.loadingSprites.indexOf(t),1)}))}isLoading(){return this.loadingSprites.length>0}}function l(t,e,s){const i=t/(e/s);return(new r.M3x3).transition(-1,1).scale(2/i,-2/s)}},"./node_modules/tslib/tslib.es6.js":(t,e,s)=>{s.r(e),s.d(e,{__assign:()=>a,__asyncDelegator:()=>x,__asyncGenerator:()=>w,__asyncValues:()=>S,__await:()=>v,__awaiter:()=>c,__classPrivateFieldGet:()=>A,__classPrivateFieldIn:()=>R,__classPrivateFieldSet:()=>M,__createBinding:()=>u,__decorate:()=>o,__exportStar:()=>p,__extends:()=>r,__generator:()=>d,__importDefault:()=>O,__importStar:()=>T,__makeTemplateObject:()=>P,__metadata:()=>h,__param:()=>l,__read:()=>f,__rest:()=>n,__spread:()=>y,__spreadArray:()=>b,__spreadArrays:()=>m,__values:()=>g});var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])},i(t,e)};function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function s(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)}var a=function(){return a=Object.assign||function(t){for(var e,s=1,i=arguments.length;s<i;s++)for(var r in e=arguments[s])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},a.apply(this,arguments)};function n(t,e){var s={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(s[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(s[i[r]]=t[i[r]])}return s}function o(t,e,s,i){var r,a=arguments.length,n=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,s,i);else for(var o=t.length-1;o>=0;o--)(r=t[o])&&(n=(a<3?r(n):a>3?r(e,s,n):r(e,s))||n);return a>3&&n&&Object.defineProperty(e,s,n),n}function l(t,e){return function(s,i){e(s,i,t)}}function h(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function c(t,e,s,i){return new(s||(s=Promise))((function(r,a){function n(t){try{l(i.next(t))}catch(t){a(t)}}function o(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(n,o)}l((i=i.apply(t,e||[])).next())}))}function d(t,e){var s,i,r,a,n={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(s)throw new TypeError("Generator is already executing.");for(;n;)try{if(s=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return n.label++,{value:a[1],done:!1};case 5:n.label++,i=a[1],a=[0];continue;case 7:a=n.ops.pop(),n.trys.pop();continue;default:if(!((r=(r=n.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){n=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){n.label=a[1];break}if(6===a[0]&&n.label<r[1]){n.label=r[1],r=a;break}if(r&&n.label<r[2]){n.label=r[2],n.ops.push(a);break}r[2]&&n.ops.pop(),n.trys.pop();continue}a=e.call(t,n)}catch(t){a=[6,t],i=0}finally{s=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}}var u=Object.create?function(t,e,s,i){void 0===i&&(i=s);var r=Object.getOwnPropertyDescriptor(e,s);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[s]}}),Object.defineProperty(t,i,r)}:function(t,e,s,i){void 0===i&&(i=s),t[i]=e[s]};function p(t,e){for(var s in t)"default"===s||Object.prototype.hasOwnProperty.call(e,s)||u(e,t,s)}function g(t){var e="function"==typeof Symbol&&Symbol.iterator,s=e&&t[e],i=0;if(s)return s.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function f(t,e){var s="function"==typeof Symbol&&t[Symbol.iterator];if(!s)return t;var i,r,a=s.call(t),n=[];try{for(;(void 0===e||e-- >0)&&!(i=a.next()).done;)n.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(s=a.return)&&s.call(a)}finally{if(r)throw r.error}}return n}function y(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(f(arguments[e]));return t}function m(){for(var t=0,e=0,s=arguments.length;e<s;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<s;e++)for(var a=arguments[e],n=0,o=a.length;n<o;n++,r++)i[r]=a[n];return i}function b(t,e,s){if(s||2===arguments.length)for(var i,r=0,a=e.length;r<a;r++)!i&&r in e||(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}function v(t){return this instanceof v?(this.v=t,this):new v(t)}function w(t,e,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=s.apply(t,e||[]),a=[];return i={},n("next"),n("throw"),n("return"),i[Symbol.asyncIterator]=function(){return this},i;function n(t){r[t]&&(i[t]=function(e){return new Promise((function(s,i){a.push([t,e,s,i])>1||o(t,e)}))})}function o(t,e){try{(s=r[t](e)).value instanceof v?Promise.resolve(s.value.v).then(l,h):c(a[0][2],s)}catch(t){c(a[0][3],t)}var s}function l(t){o("next",t)}function h(t){o("throw",t)}function c(t,e){t(e),a.shift(),a.length&&o(a[0][0],a[0][1])}}function x(t){var e,s;return e={},i("next"),i("throw",(function(t){throw t})),i("return"),e[Symbol.iterator]=function(){return this},e;function i(i,r){e[i]=t[i]?function(e){return(s=!s)?{value:v(t[i](e)),done:"return"===i}:r?r(e):e}:r}}function S(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,s=t[Symbol.asyncIterator];return s?s.call(t):(t=g(t),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(s){e[s]=t[s]&&function(e){return new Promise((function(i,r){!function(t,e,s,i){Promise.resolve(i).then((function(e){t({value:e,done:s})}),e)}(i,r,(e=t[s](e)).done,e.value)}))}}}function P(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var E=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e};function T(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var s in t)"default"!==s&&Object.prototype.hasOwnProperty.call(t,s)&&u(e,t,s);return E(e,t),e}function O(t){return t&&t.__esModule?t:{default:t}}function A(t,e,s,i){if("a"===s&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?i:"a"===s?i.call(t):i?i.value:e.get(t)}function M(t,e,s,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(t,s):r?r.value=s:e.set(t,s),s}function R(t,e){if(null===e||"object"!=typeof e&&"function"!=typeof e)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof t?e===t:t.has(e)}},"./libs/renderend/src/display-config.json":t=>{t.exports=JSON.parse('{"renderToVirtualSize":true,"virtualPixelsPerTile":16,"virtualHeight":160,"font":"Vt323","assetFolder":"assets/","inputs":{"Restart":["Escape","Enter","PadStart"],"MoveUp":["W","Up","PadUp","PadLeftStickUp"],"MoveDown":["S","Down","PadDown","PadLeftStickDown"],"MoveLeft":["A","Left","PadLeft","PadLeftStickLeft"],"MoveRight":["D","Right","PadRight","PadLeftStickRight"],"MoveSlow":["LeftShift","PadA"],"Shoot":["Space","PadB"]},"sprites":{"full-shield":{"path":"full-shield","width":20,"height":20,"centerX":10,"centerY":10,"framesX":4,"framesY":1,"frameInterval":10},"half-shield":{"path":"half-shield","width":20,"height":20,"centerX":10,"centerY":10,"framesX":4,"framesY":1,"frameInterval":10},"ship":{"path":"ship","width":20,"height":20,"centerX":10,"centerY":10,"framesX":4,"framesY":2,"frameInterval":6},"charge-1":{"path":"charge-1","width":20,"height":20,"centerX":10,"centerY":10},"charge-2":{"path":"charge-2","width":20,"height":20,"centerX":10,"centerY":10},"charge-3":{"path":"charge-3","width":20,"height":20,"centerX":10,"centerY":10},"charge-4":{"path":"charge-4","width":20,"height":20,"centerX":10,"centerY":10},"wall":{"path":"wall","width":16,"height":16,"centerX":8,"centerY":8},"obstacle":{"path":"obstacle","width":16,"height":16,"centerX":8,"centerY":8},"obstacle-explosion":{"path":"obstacle-explosion","width":16,"height":16,"centerX":8,"centerY":8,"framesX":4,"framesY":1,"frameInterval":10},"big-obstacle":{"path":"big-obstacle","width":32,"height":32,"centerX":16,"centerY":16},"big-obstacle-explosion":{"path":"big-obstacle-explosion","width":32,"height":32,"centerX":16,"centerY":16,"framesX":4,"framesY":1,"frameInterval":10},"bullet":{"path":"bullet","width":8,"height":8,"centerX":4,"centerY":4,"framesX":3,"framesY":1,"frameInterval":5},"bullet-explosion":{"path":"bullet-explosion","width":8,"height":8,"centerX":4,"centerY":4,"framesX":4,"framesY":1,"frameInterval":5},"background":{"path":"starry-background","width":450,"height":160}}}')},"./libs/renderend/src/game-config.json":t=>{t.exports=JSON.parse('{"constants":{"shipType":"ship","wallType":"wall","obstacleTypes":["obstacle","obstacle","obstacle","obstacle","obstacle","obstacle","big-obstacle"]},"types":{"ship":{"shipBehaviour":true,"dieOnCollisionBehaviour":true,"health":3,"damage":1,"charge":0,"bulletType":"bullet"},"wall":{"rectangularSize":{"width":1,"height":1},"obstacleBehaviour":true,"damage":3},"obstacle":{"rectangularSize":{"width":1,"height":1},"obstacleBehaviour":true,"health":1,"damage":1},"big-obstacle":{"rectangularSize":{"width":2,"height":2},"obstacleBehaviour":true,"health":2,"damage":3},"bullet":{"rectangularSize":{"width":0.25,"height":0.25},"health":1,"damage":0.5,"velocity":{"x":0.15,"y":0}}}}')}},i={};function r(t){var e=i[t];if(void 0!==e)return e.exports;var a=i[t]={exports:{}};return s[t](a,a.exports,r),a.exports}e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,r.t=function(s,i){if(1&i&&(s=this(s)),8&i)return s;if("object"==typeof s&&s){if(4&i&&s.__esModule)return s;if(16&i&&"function"==typeof s.then)return s}var a=Object.create(null);r.r(a);var n={};t=t||[null,e({}),e([]),e(e)];for(var o=2&i&&s;"object"==typeof o&&!~t.indexOf(o);o=e(o))Object.getOwnPropertyNames(o).forEach((t=>n[t]=()=>s[t]));return n.default=()=>s,r.d(a,n),a},r.d=(t,e)=>{for(var s in e)r.o(e,s)&&!r.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var a={};return(()=>{r.r(a),r.d(a,{DisplayProvider:()=>s.DisplayProvider,MoveShipAction:()=>i.MoveShipAction,Renderend:()=>t.Renderend,RenderendAction:()=>i.RenderendAction,RenderendDisplay:()=>e.RenderendDisplay,RenderendGame:()=>s.RenderendGame,ShootBulletAction:()=>i.ShootBulletAction,StartGameAction:()=>i.StartGameAction});var t=r("./libs/renderend/src/renderend.ts"),e=r("./libs/renderend/src/renderend-display.ts"),s=r("./libs/renderend/src/renderend-game.ts"),i=r("./libs/renderend/src/state/renderend-action.ts")})(),a})()));