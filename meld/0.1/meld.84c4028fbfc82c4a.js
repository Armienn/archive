!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var s=e();for(var i in s)("object"==typeof exports?exports:t)[i]=s[i]}}(self,(()=>(()=>{"use strict";var t,e,s={"./libs/age/src/age.ts":(t,e,s)=>{s.r(e),s.d(e,{AgEngine:()=>i});class i{constructor(t,e,s){this.logics=t,this.validators=e,this.state=s}update(...t){return this.validate(t)||(this.performLogic(t),{isValid:!0,problems:[]})}validate(t){for(const e of this.validators){const s=e.validate(t);if(!s.isValid)return s}}performLogic(t){this.state.tick++;for(const e of this.logics)e.update(t);this.state.finishUpdate?.()}}},"./libs/age/src/base-display.ts":(t,e,s)=>{s.r(e)},"./libs/age/src/base-game.ts":(t,e,s)=>{s.r(e),s.d(e,{BaseGame:()=>i});class i{constructor(t=[],e=[]){this.logics=t,this.validators=e}update(...t){const e=this.validate(t);if(e)return e;for(const e of this.logics)e.update(t);return{isValid:!0,problems:[]}}validate(t){for(const e of this.validators){const s=e.validate(t);if(!s.isValid)return s}}}},"./libs/age/src/display/base-input-parser.ts":(t,e,s)=>{s.r(e),s.d(e,{BaseInputParser:()=>i});class i{constructor(t,e,s=new Map,i=new Map){this.displayProvider=t,this.inputs=e,this.actionStates=s,this.previousStates=i}updateActionStates(){this.previousStates=this.actionStates,this.actionStates=new Map;for(const[t,e]of this.inputs)this.actionStates.set(t,this.stateFor(...e))}stateFor(...t){return t.map((t=>this.displayProvider.getInputState(t))).max()}floatStateFor(t){return this.actionStates.get(t)}boolStateFor(t){return this.actionStates.get(t)>.5}hasJustBeenPressed(t){return this.actionStates.get(t)>.5&&this.previousStates.get(t)<=.5}hasJustBeenReleased(t){return this.actionStates.get(t)<=.5&&this.previousStates.get(t)>.5}}},"./libs/age/src/display/html-display-provider.ts":(t,e,s)=>{s.r(e),s.d(e,{HtmlDisplayProvider:()=>o});var i=s("./libs/utility/src/index.ts"),r=s("./libs/web-gl-display/src/index.ts"),a=s("./libs/age/src/display/screen-size.ts");class o{constructor(t,e){this.hostElement=t,this.config=e,this.textElements={},this.keyStates=new i.KeyStates,this.size=new a.ScreenSize(e.renderToVirtualSize,e.virtualPixelsPerTile,100,100,e.virtualHeight,e.virtualHeight),this.initialiseCanvas(),this.initialiseDisplay()}get sortByDepth(){return this.display.sortByDepth}set sortByDepth(t){this.display.sortByDepth=t}initialiseCanvas(){this.hostElement.style.position="relative",this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.config.renderToVirtualSize&&(this.canvas.style.width="100%",this.canvas.style.imageRendering="pixelated"),this.hostElement.appendChild(this.canvas)}initialiseDisplay(){const t=this.display?.sortByDepth??!1;this.display=new r.WebGl2Display(this.canvas,this.config.virtualPixelsPerTile,this.config.virtualHeight,this.config.renderToVirtualSize),this.display.sortByDepth=t;for(const[t,e]of Object.entries(this.config.sprites))this.display.addSprite(t,this.config.assetFolder+e.path+".png",e.width,e.height,e.centerX,e.centerY)}startFrame(){this.display.startFrame(),this.updateTextElements()}updateTextElements(){for(const t in this.textElements)"none"===this.textElements[t].style.display?this.removeElement(t):this.textElements[t].style.display="none"}removeElement(t){const e=this.textElements[t];this.hostElement.removeChild(e),delete this.textElements[t]}draw(t,e,s,i,r,a=1){this.display.isLoading()||this.display.draw(t,e,s,i,r,a)}endFrame(){this.display.endFrame()}drawString(t,e,s,i,r,a="white"){const o=this.getTextElement(e,s,i,a,r);o.innerText=t,o.style.display="block"}getTextElement(t,e,s,i,r){const a=t+","+e+s+i+r;return this.textElements[a]||(this.textElements[a]=this.createTextElement(t,e,s,i,r)),this.textElements[a]}createTextElement(t,e,s,i,r){const a=document.createElement("div");return a.style.position="absolute",a.style.fontFamily=`'${s}', Courier, monospace`,a.style.fontWeight="bold",a.style.display="none",a.style.backgroundColor="rgba(0,0,0,0.5)",a.style.textAlign="center",a.style.color=i,a.style.left=this.size.hostPixelsPerTile*(t-3)+"px",a.style.top=this.size.hostPixelsPerTile*e+"px",a.style.fontSize=this.size.hostPixelsPerTile*r+"px",a.style.width=6*this.size.hostPixelsPerTile+"px",a.style.lineHeight=this.size.hostPixelsPerTile*r*2+"px",this.hostElement.appendChild(a),a}getInputState(t){t=this.translateInputString(t);const e=this.keyStates.getInputState(t);switch(t){case"MouseX":return this.modifyMouseX(e);case"MouseY":return this.modifyMouseY(e);default:return e}}modifyMouseX(t){const e=this.hostElement.getBoundingClientRect();return(t-e.x)/e.width}modifyMouseY(t){const e=this.hostElement.getBoundingClientRect();return(t-e.y)/e.height}translateInputString(t){if(1===t.length)return"Key"+t;switch(t){case"Up":return"ArrowUp";case"Down":return"ArrowDown";case"Left":return"ArrowLeft";case"Right":return"ArrowRight";case"LeftShift":return"ShiftLeft"}return t}setSize(t,e){this.size.updateHostSize(t,e),this.canvas.width=this.size.canvasWidth,this.canvas.height=this.size.canvasHeight,this.initialiseDisplay()}}},"./libs/age/src/display/screen-size.ts":(t,e,s)=>{s.r(e),s.d(e,{ScreenSize:()=>i});class i{constructor(t,e,s,i,r,a){this.renderToVirtualSize=t,this.virtualPixelsPerTile=e,this.hostWidth=s,this.hostHeight=i,this.virtualWidth=r,this.virtualHeight=a}get hostPixelsPerTile(){return this.hostHeight/this.virtualHeight*this.virtualPixelsPerTile}get canvasWidth(){return this.renderToVirtualSize?this.virtualWidth:this.hostWidth}get canvasHeight(){return this.renderToVirtualSize?this.virtualHeight:this.hostHeight}get widthInTiles(){return this.virtualWidth/this.virtualPixelsPerTile}get heightInTiles(){return this.virtualHeight/this.virtualPixelsPerTile}updateHostSize(t,e){this.hostWidth=t,this.hostHeight=e,this.virtualWidth=this.hostWidth*(this.virtualHeight/this.hostHeight)}}},"./libs/age/src/game-runner.ts":(t,e,s)=>{s.r(e),s.d(e,{GameRunner:()=>i});class i{constructor(t,e,s=30){this.display=t,this.game=e,this.updatesPerSecond=s,this.lastUpdate=Date.now(),this.stop=!1,this.actions=[],this.updateGame=()=>{this.game.update(...this.actions.splice(0),...this.display.getNewActions()),this.lastUpdate=Date.now()},this.startDisplayLoop=()=>{this.updateDisplay(),this.stop||requestAnimationFrame(this.startDisplayLoop)}}startGameLoop(){this.stopInterval(),this.timerId=window.setInterval(this.updateGame,1e3/this.updatesPerSecond)}stopInterval(){this.timerId&&window.clearInterval(this.timerId),this.timerId=null}updateDisplay(){const t=Date.now(),e=1e3/this.updatesPerSecond,s=(t-this.lastUpdate)/e;this.display.show(s)}onDestroy(){this.stop=!0,window.clearInterval(this.timerId),this.display.onDestroy?.()}}},"./libs/age/src/index.ts":(t,e,s)=>{s.r(e),s.d(e,{AgEngine:()=>i.AgEngine,BaseGame:()=>r.BaseGame,BaseInputParser:()=>o.BaseInputParser,BaseValues:()=>u.BaseValues,BlockChunk:()=>y.BlockChunk,Box:()=>b.Box,Box2d:()=>v.Box2d,CircularSize:()=>S.CircularSize,EntityManager:()=>p.EntityManager,GameGrid:()=>g.GameGrid,GameRunner:()=>a.GameRunner,HtmlDisplayProvider:()=>l.HtmlDisplayProvider,Random:()=>h.Random,RandomAi:()=>c.RandomAi,RectangularSize:()=>x.RectangularSize,ScreenSize:()=>n.ScreenSize,StandardValueGetter:()=>w.StandardValueGetter,TerrainManager:()=>m.TerrainManager,TypeMap:()=>f.TypeMap,ValueAccessBuilder:()=>w.ValueAccessBuilder,ValueAccessor:()=>w.ValueAccessor,ValueSetter:()=>w.ValueSetter,typeMask:()=>d.typeMask,typeOf:()=>d.typeOf,typeOffset:()=>d.typeOffset});var i=s("./libs/age/src/age.ts"),r=(s("./libs/age/src/base-display.ts"),s("./libs/age/src/base-game.ts")),a=s("./libs/age/src/game-runner.ts"),o=s("./libs/age/src/display/base-input-parser.ts"),l=s("./libs/age/src/display/html-display-provider.ts"),n=s("./libs/age/src/display/screen-size.ts"),c=s("./libs/age/src/interfaces/game-ai.ts"),h=(s("./libs/age/src/interfaces/game-logic.ts"),s("./libs/age/src/interfaces/game-state.ts"),s("./libs/age/src/interfaces/game-validator.ts"),s("./libs/age/src/services/random.ts")),d=s("./libs/age/src/state/id.ts"),u=s("./libs/age/src/state/base-values.ts"),y=s("./libs/age/src/state/block-chunk.ts"),p=s("./libs/age/src/state/entity-manager.ts"),g=s("./libs/age/src/state/game-grid.ts"),m=s("./libs/age/src/state/terrain-manager.ts"),f=s("./libs/age/src/state/type-map.ts"),w=s("./libs/age/src/state/value-accessor.ts"),b=s("./libs/age/src/values/box.ts"),v=s("./libs/age/src/values/box2d.ts"),x=s("./libs/age/src/values/rectangular-size.ts"),S=s("./libs/age/src/values/circular-size.ts")},"./libs/age/src/interfaces/game-ai.ts":(t,e,s)=>{s.r(e),s.d(e,{RandomAi:()=>i});class i{constructor(t){this.possibleActionsFor=t}requestActions(t){const e=this.possibleActionsFor(t);return[e[Math.floor(Math.random()*e.length)]]}}},"./libs/age/src/interfaces/game-logic.ts":(t,e,s)=>{s.r(e)},"./libs/age/src/interfaces/game-state.ts":(t,e,s)=>{s.r(e)},"./libs/age/src/interfaces/game-validator.ts":(t,e,s)=>{s.r(e)},"./libs/age/src/services/random.ts":(t,e,s)=>{s.r(e),s.d(e,{Random:()=>i});class i{constructor(t,e=-1,s=new r(-1)){this.getSeed=t,this.previousSeed=e,this.generator=s}get get(){const t=this.getSeed();return this.previousSeed===t||(this.previousSeed=t,this.generator=new r(t)),this.generator}}class r{constructor(t){this.seed=t}int(t){return Math.floor(Math.random()*t)}float(t){return Math.random()*t}in(t){return t[this.int(t.length)]}}},"./libs/age/src/state/base-values.ts":(t,e,s)=>{s.r(e),s.d(e,{BaseValues:()=>i});class i{constructor(t=new Map){this.entities=t,this.allValueMaps=[]}register(t){return this.allValueMaps.push(t),t}clearValues(){for(const t of this.allValueMaps)t.clear()}removeValuesFor(t){for(const e of this.allValueMaps)e.delete(t)}addValuesFromOther(t){for(let e=0;e<this.allValueMaps.length;e++)for(const[s,i]of t.allValueMaps[e])this.allValueMaps[e].set(s,i)}}},"./libs/age/src/state/block-chunk.ts":(t,e,s)=>{s.r(e),s.d(e,{BlockChunk:()=>r});var i=s("./libs/utility/src/index.ts");class r{constructor(t,e=new i.Vector3(10,10,1),s=new i.Vector3(0,0,0)){this.blocks=t,this.chunkSize=e,this.offset=s}get(t,e,s){return this.blocks[this.chunkIndexFor(t-this.offset.x,e-this.offset.y,s-this.offset.z)]}set(t,e,s,i){return this.blocks[this.chunkIndexFor(t-this.offset.x,e-this.offset.y,s-this.offset.z)]=i}chunkIndexFor(t,e,s){return t+e*this.chunkSize.x+s*this.chunkSize.x*this.chunkSize.y}}},"./libs/age/src/state/entity-manager.ts":(t,e,s)=>{s.r(e),s.d(e,{EntityManager:()=>i});class i{constructor(t,e,s){this.entityValues=t,this.updatedEntityValues=e,this.idProvider=s,this.valueAccessors=[]}get with(){return this.entityValues}create(t){const e=this.idProvider.getNewId()|t;this.updatedEntityValues.entities.set(e,!0);for(const t of this.valueAccessors)t.initialiseValueFor(e);return e}remove(...t){for(const e of t)this.updatedEntityValues.entities.set(e,!1)}applyUpdatedValues(){this.entityValues.addValuesFromOther(this.updatedEntityValues),this.updatedEntityValues.clearValues();for(const[t,e]of this.updatedEntityValues.entities)e?this.add(t):this.fullyRemove(t);this.updatedEntityValues.entities.clear(),this.updatedEntityValues.entities.clear()}add(t){this.entityValues.entities.set(t,!0)}fullyRemove(t){this.entityValues.entities.delete(t),this.updatedEntityValues.entities.delete(t),this.entityValues.removeValuesFor(t),this.updatedEntityValues.removeValuesFor(t)}*[Symbol.iterator](){for(const[t]of this.entityValues.entities)yield t}}},"./libs/age/src/state/game-grid.ts":(t,e,s)=>{s.r(e),s.d(e,{GameGrid:()=>r});var i=s("./libs/utility/src/index.ts");class r{constructor(t,e,s=(()=>null)){this.width=t,this.height=e,this.setAll(s)}setAll(t){this.grid=[];for(const{x:e,y:s}of this.allFields())this.grid.push(t(e,s))}*allFields(){for(const t of(0,i.range)(0,this.height))for(const e of(0,i.range)(0,this.width))yield{x:e,y:t,field:this.get(e,t)}}*fieldsAround(t,e,s=1){for(const r of(0,i.range)(t-s,t+s+1))for(const t of(0,i.range)(e-s,e+s+1))this.isWithinBounds(r,t)&&(yield{i:r,j:t,field:this.get(r,t)})}get(t,e){return this.grid[this.indexFor(t,e)]}set(t,e,s){this.grid[this.indexFor(t,e)]=s}isWithinBounds(t,e){return 0<=t&&t<this.width&&0<=e&&e<this.height}indexFor(t,e){return t+e*this.width}}},"./libs/age/src/state/id.ts":(t,e,s)=>{s.r(e),s.d(e,{typeMask:()=>i,typeOf:()=>a,typeOffset:()=>r});const i=4278190080,r=24;function a(t){return t&i}},"./libs/age/src/state/terrain-manager.ts":(t,e,s)=>{s.r(e),s.d(e,{TerrainManager:()=>a});var i=s("./libs/utility/src/index.ts"),r=s("./libs/age/src/state/block-chunk.ts");class a{constructor(t=new i.Vector3(10,10,1),e,s=new Map){this.chunkSize=t,this.chunks=e,this.updatedBlocks=s}addChunk(t,e,s){const a=new i.Vector3(this.chunkSize.x*t,this.chunkSize.y*e,this.chunkSize.z*s);this.chunks.set(i.Vector3.stringify(t,e,s),new r.BlockChunk([],this.chunkSize,a))}get(t,e,s=0){return t=Math.floor(t),e=Math.floor(e),s=Math.floor(s),this.chunks.get(this.getChunkCoords(t,e,s))?.get(t,e,s)}getAt(t){return this.get(t.x,t.y,t.z)}getChunkCoords(t,e,s){return i.Vector3.stringify(this.chunkCoord(t,this.chunkSize.x),this.chunkCoord(e,this.chunkSize.y),this.chunkCoord(s,this.chunkSize.z))}chunkCoord(t,e){return Math.floor(t/e)}chunkIndexFor(t,e,s){return t+e*this.chunkSize.x+s*this.chunkSize.x*this.chunkSize.y}getCurrent(t,e,s=0){return t=Math.floor(t),e=Math.floor(e),s=Math.floor(s),this.updatedBlocks.get(i.Vector3.stringify(t,e,s))??this.get(t,e,s)}*allFields(){for(const[t,e]of this.chunks){const[s,r,a]=t.split(",").map((t=>+t));for(const t of(0,i.range)(0,this.chunkSize.z))for(const o of(0,i.range)(0,this.chunkSize.y))for(const l of(0,i.range)(0,this.chunkSize.x))yield{position:this.getGlobalPosition(l,o,t,s,r,a),field:e[this.chunkIndexFor(l,o,t)]}}}*allFieldsInChunk(t=0,e=0,s=0){const r=this.chunks.get(i.Vector3.stringify(t,e,s));if(r)for(const a of(0,i.range)(0,this.chunkSize.z))for(const o of(0,i.range)(0,this.chunkSize.y))for(const l of(0,i.range)(0,this.chunkSize.x))yield{global:this.getGlobalPosition(l,o,a,t,e,s),x:l,y:o,z:a,field:r[this.chunkIndexFor(l,o,a)]}}fieldsAround(t,e,s=0){return this.fieldsWithinRadius(t,e,s,1,1,0)}*fieldsWithinRadius(t,e,s,r=1,a=1,o=1){for(const l of(0,i.range)(t-r,t+r+1))for(const t of(0,i.range)(e-a,e+a+1))for(const e of(0,i.range)(s-o,s+o+1))yield{i:l,j:t,k:e,field:this.get(l,t,e)}}getGlobalPosition(t,e,s,r,a,o=0){return new i.Vector3(t+r*this.chunkSize.x,e+a*this.chunkSize.y,s+o*this.chunkSize.z)}set(t,e,s,r=0){e=Math.floor(e),s=Math.floor(s),r=Math.floor(r),this.updatedBlocks.set(i.Vector3.stringify(e,s,r),t)}setAt(t,e){const s=i.Vector3.stringify(Math.floor(t.x),Math.floor(t.y),Math.floor(t.z));this.updatedBlocks.set(s,e)}applyUpdatedValues(){for(const[t,e]of this.updatedBlocks)this.setField(i.Vector3.parse(t),e);this.updatedBlocks.clear()}setField(t,e){const s=this.chunks.get(this.getChunkCoords(t.x,t.y,t.z));s?s.set(t.x,t.y,t.z,e):console.error(`Can't set field outside chunks at (${t.x}, ${t.y}, ${t.z})`)}}},"./libs/age/src/state/type-map.ts":(t,e,s)=>{s.r(e),s.d(e,{TypeMap:()=>r});var i=s("./libs/age/src/state/id.ts");class r{constructor(t=new Map){this.types=t}static from(t){const e=new r;for(const[s,r]of t.entries())e.types.set(r,s<<i.typeOffset);return e}typeFor(t){for(const[e,s]of this.types.entries())if(t===s)return e}typeIdFor(t){return this.types.get(t)}}},"./libs/age/src/state/value-accessor.ts":(t,e,s)=>{s.r(e),s.d(e,{StandardValueGetter:()=>a,ValueAccessBuilder:()=>l,ValueAccessor:()=>r,ValueSetter:()=>o});var i=s("./libs/age/src/state/id.ts");class r{constructor(t,e){this.get=t,this.set=e}initialiseValueFor(t){const e=this.get.defaultOf(t);null!=e&&this.set.for(t,e)}}class a{constructor(t,e,s,i,r){this.typeValues=t,this.entityValue=e,this.updatedEntityValue=s,this.getTypeValue=i,this.defaultValue=r}currentlyOf(t){return this.updatedEntityValue.get(t)??this.of(t)}of(t){return this.entityValue.get(t)}defaultOf(t){const e=(0,i.typeOf)(t);return this.getTypeValue(this.typeValues.get(e))??this.defaultValue}}class o{constructor(t){this.updatedEntityValue=t}for(t,e){this.updatedEntityValue.set(t,e)}}class l{constructor(t,e,s){this.typeValues=t,this.entityValues=e,this.updatedEntityValues=s}for(t,e,s){return new r(new a(this.typeValues,t(this.entityValues),t(this.updatedEntityValues),e,s),new o(t(this.updatedEntityValues)))}}},"./libs/age/src/values/box.ts":(t,e,s)=>{s.r(e),s.d(e,{Box:()=>i});class i{constructor(t,e,s,i,r,a){this.minX=t,this.maxX=e,this.minY=s,this.maxY=i,this.minZ=r,this.maxZ=a}static from(t){return new i(t.x,t.x,t.y,t.y,t.z,t.z)}translateBy(t){return new i(this.minX+t.x,this.maxX+t.x,this.minY+t.y,this.maxY+t.y,this.minZ+t.z,this.maxZ+t.z)}static occupiedArea(t,e){return new i(t.x-e.radius,t.x+e.radius,t.y-e.radius,t.y+e.radius,t.z,t.z+e.height)}contains(t){return this.minX<=t.x&&t.x<=this.maxX&&this.minY<=t.y&&t.y<=this.maxY&&this.minZ<=t.z&&t.z<=this.maxZ}}},"./libs/age/src/values/box2d.ts":(t,e,s)=>{s.r(e),s.d(e,{Box2d:()=>i});class i{constructor(t,e,s,i){this.minX=t,this.maxX=e,this.minY=s,this.maxY=i}static from(t,e){return new i(t.x-e.width/2,t.x+e.width/2,t.y-e.height/2,t.y+e.height/2)}translateBy(t){return new i(this.minX+t.x,this.maxX+t.x,this.minY+t.y,this.maxY+t.y)}contains(t){return this.minX<=t.x&&t.x<=this.maxX&&this.minY<=t.y&&t.y<=this.maxY}}},"./libs/age/src/values/circular-size.ts":(t,e,s)=>{s.r(e),s.d(e,{CircularSize:()=>i});class i{constructor(t,e){this.radius=t,this.height=e}}},"./libs/age/src/values/rectangular-size.ts":(t,e,s)=>{s.r(e),s.d(e,{RectangularSize:()=>i});class i{constructor(t,e){this.width=t,this.height=e}}},"./libs/meld/src/config/constants.ts":(t,e,s)=>{s.r(e),s.d(e,{Constants:()=>a});var i=s("./libs/utility/src/index.ts"),r=s("./libs/meld/src/meld-game.ts");class a{constructor(t,e=new i.Vector3(50,50,5),s=1,a=1/1024,o=.5/r.updatesPerSecond,l=10/r.updatesPerSecond,n=10/r.updatesPerSecond){this.playerType=t,this.chunkSize=e,this.chunkLoadingRadius=s,this.collisionAreaWidth=a,this.gravityAcceleration=o,this.terminalVerticalVelocity=l,this.maxMoveSpeed=n}}},"./libs/meld/src/config/game-config.ts":(t,e,s)=>{s.r(e),s.d(e,{GameConfig:()=>i});class i{constructor(t,e,s,i,r,a,o){this.constants=t,this.entityTypeMap=e,this.entityTypeValues=s,this.solidTypeMap=i,this.solidTypeValues=r,this.nonSolidTypeMap=a,this.nonSolidTypeValues=o}}},"./libs/meld/src/display/camera.ts":(t,e,s)=>{s.r(e),s.d(e,{Camera:()=>r,DisplayArea:()=>a,Layer:()=>o});var i=s("./libs/utility/src/index.ts");class r{constructor(t,e,s,i,r=[]){this.game=t,this.displayProvider=e,this.config=s,this.state=i,this.shownLayers=r}get top(){return this.state.focusPoint.y-this.state.size.heightInTiles/2}get bottom(){return this.state.focusPoint.y+this.state.size.heightInTiles/2}get left(){return this.state.focusPoint.x-this.state.size.widthInTiles/2}get right(){return this.state.focusPoint.x+this.state.size.widthInTiles/2}get topPosition(){return new i.Vector3(0,-1,0)}get bottomPosition(){return new i.Vector3(0,1,0)}get leftPosition(){return new i.Vector3(-1,0,0)}get rightPosition(){return new i.Vector3(1,0,0)}focusOn(t){this.state.focusPoint=this.currentPositionFrom(this.game.entities.position.get.of(t)??new i.Vector3(0,0,0),this.game.entities.velocity.get.of(t)),this.updateShownLayers()}updateShownLayers(){this.shownLayers.clear();for(let t=-this.config.displayDepth;t<=this.config.displayDepth;t++)this.shownLayers.push({layer:t+Math.floor(this.state.focusPoint.z),area:this.displayAreaFor(t)})}displayAreaFor(t){return new a(this.top+t*this.config.wallDisplayHeight,this.bottom+t*this.config.wallDisplayHeight,this.left,this.right)}currentPositionFrom(t,e=null){return e?t.add(e.multiply(this.state.fractionOfTick)):t}drawAnimated(t,e,s,i=null,r=0){const a=this.config.sprites[t],o=this.animationFrame(a.frameInterval,a.framesX,a.framesY,r);this.draw(t,e,s,i,o)}animationFrame(t,e,s,i){if(!t)return 0;const r=e*s,a=this.game.state.globals.tick-i;return Math.floor(a/t)%r}drawVaried(t,e,s,i=null,r=0){const a=this.config.sprites[t],o=a.frameWeights.sum();let l=0,n=0;for(const t of a.frameWeights){if(n+=t,n>r%o)break;l++}this.draw(t,e,s,i,l)}draw(t,e,s,i=null,r=0){const a=this.currentPositionFrom(s,i),o=this.screenPositionFor(a),l=this.config.sprites[t],n=r%l.framesX,c=Math.floor(r/l.framesX)%l.framesY;this.displayProvider.draw(t,o.x,o.y,n,c,this.sortingNumberFor(a,e))}screenPositionFor(t){return new i.Vector2(t.x-this.left,t.y-this.top-this.config.wallDisplayHeight*(t.z-this.state.focusPoint.z))}sortingNumberFor(t,e){const s=Math.floor(t.z)+e,i=2*this.config.displayDepth+3,r=(s-(this.state.focusPoint.z-i/2))/i,a=this.state.size.heightInTiles+(2*this.config.displayDepth+1)*this.config.wallDisplayHeight,l=this.state.focusPoint.y-a/2;return r+(t.y-l)/a/o.NumberOfLayers/i}tilePositionFor(t,e){return new i.Vector3(t*this.state.size.widthInTiles,e*this.state.size.heightInTiles,0).add(new i.Vector3(this.left,this.top,0))}}class a{constructor(t,e,s,i){this.top=t,this.bottom=e,this.left=s,this.right=i}}class o{}o.NumberOfLayers=4,o.Bottom=0,o.Floor=1/o.NumberOfLayers,o.Middle=2/o.NumberOfLayers,o.Top=3/o.NumberOfLayers,o.ZFightingAdjustment=1e-4,o.OverlayNorthAdjustment=1*o.ZFightingAdjustment,o.OverlayEastAdjustment=2*o.ZFightingAdjustment,o.OverlayWestAdjustment=3*o.ZFightingAdjustment,o.OverlaySouthAdjustment=4*o.ZFightingAdjustment},"./libs/meld/src/display/display-state.ts":(t,e,s)=>{s.r(e),s.d(e,{DisplayState:()=>a});var i=s("./libs/age/src/index.ts"),r=s("./libs/utility/src/index.ts");class a{constructor(t,e="",s=0,i=new r.Vector3(0,0,0),a=[]){this.size=t,this.playerName=e,this.fractionOfTick=s,this.focusPoint=i,this.displayEntities=a}static from(t,e){return new a(new i.ScreenSize(t.renderToVirtualSize,t.virtualPixelsPerTile,100,100,t.virtualHeight,t.virtualHeight),e)}}},"./libs/meld/src/display/entity-drawer.ts":(t,e,s)=>{s.r(e),s.d(e,{EntityDrawer:()=>a});var i=s("./libs/age/src/index.ts"),r=s("./libs/meld/src/display/camera.ts");class a{constructor(t,e){this.game=t,this.camera=e}draw(t){(0,i.typeOf)(t)===this.game.config.constants.playerType?this.drawPlayer(t):this.drawGeneralEntity(t)}drawGeneralEntity(t){const e=this.game.entities.position.get.of(t),s=this.game.entities.velocity.get.of(t),a=this.game.config.entityTypeMap.typeFor((0,i.typeOf)(t));this.camera.drawAnimated(a,r.Layer.Middle,e,s)}drawPlayer(t){const e=this.game.entities.position.get.of(t),s=this.game.entities.velocity.get.of(t),a=this.game.config.entityTypeMap.typeFor((0,i.typeOf)(t));this.camera.drawAnimated(a,r.Layer.Middle,e,s)}}},"./libs/meld/src/display/hud-drawer.ts":(t,e,s)=>{s.r(e),s.d(e,{HudDrawer:()=>r});var i=s("./libs/utility/src/index.ts");class r{constructor(t,e,s){this.game=t,this.state=e,this.displayProvider=s}draw(){const t=this.game.state.players.get(this.state.playerName);if(!(t>-1))return;this.drawHud();const e=this.game.entities.selectedBlock.get.of(t);e>-1&&this.drawSelectedBlock(e)}drawHud(){this.displayProvider.draw("hud-life-energy",0,0,0,0,r.BottomLayer),this.displayProvider.draw("hud-tool-items",this.state.size.widthInTiles,0,0,0,r.BottomLayer)}drawSelectedBlock(t){const e=new i.Vector2(this.state.size.widthInTiles-1,1),s=this.game.config.solidTypeMap.typeFor(t)+"-tile";this.displayProvider.draw(s,e.x,e.y,0,0,r.TopLayer)}}r.BottomLayer=.9998,r.TopLayer=.9999},"./libs/meld/src/display/input-parser.ts":(t,e,s)=>{s.r(e),s.d(e,{Input:()=>i,InputParser:()=>l});var i,r=s("./libs/age/src/index.ts"),a=s("./libs/utility/src/index.ts"),o=s("./libs/meld/src/state/game-update.ts");class l extends r.BaseInputParser{constructor(t,e,s,i,r){super(i,r),this.game=t,this.state=e,this.camera=s}parseInputs(){return this.updateActionStates(),[this.parseGenerate(),this.parseMovement(),this.parsePlaceBlock(),this.parseSelectNextItem()].filter((t=>t))}parseMovement(){const t=this.boolStateFor(i.Run)?1:.5,e=this.floatStateFor(i.MoveUp)??0,s=this.floatStateFor(i.MoveDown)??0,r=this.floatStateFor(i.MoveLeft)??0,l=this.floatStateFor(i.MoveRight)??0,n=new a.Vector2(l-r,s-e).multiply(t);return new o.MovementAction(this.game.state.players.get(this.state.playerName),n)}parseGenerate(){if(this.hasJustBeenPressed(i.Generate))return new o.GenerateAction}parsePlaceBlock(){const t=this.camera.tilePositionFor(this.displayProvider.getInputState("MouseX"),this.displayProvider.getInputState("MouseY"));if(this.hasJustBeenPressed(i.UseItem))return new o.PlaceBlockAction(this.game.state.players.get(this.state.playerName),t)}parseSelectNextItem(){if(this.hasJustBeenPressed(i.SelectNextItem))return new o.SelectNextItemAction(this.game.state.players.get(this.state.playerName))}}!function(t){t[t.Generate=0]="Generate",t[t.MoveUp=1]="MoveUp",t[t.MoveDown=2]="MoveDown",t[t.MoveLeft=3]="MoveLeft",t[t.MoveRight=4]="MoveRight",t[t.Run=5]="Run",t[t.SelectNextItem=6]="SelectNextItem",t[t.UseItem=7]="UseItem"}(i||(i={}))},"./libs/meld/src/display/terrain-drawer.ts":(t,e,s)=>{s.r(e),s.d(e,{TerrainDrawer:()=>l});var i,r=s("./libs/utility/src/index.ts"),a=s("./libs/meld/src/state/block.ts"),o=s("./libs/meld/src/display/camera.ts");class l{constructor(t,e,s){this.game=t,this.config=e,this.camera=s}drawBlockContent(t,e,s){const i=this.game.terrain.get(t,e,s);if(!i)return;const a=new r.Vector3(t,e,s),o=a.add(this.camera.rightPosition);this.drawBlockTile(i,a),this.drawBlockWall(i,a),this.drawTileOverlays(i,a),this.drawWallOverlays(i,a,o)}drawBlockTile(t,e){if(t.blockType===a.BlockType.Empty)return;const s=this.game.config.solidTypeMap.typeFor(t.solidType);if(null==s)return;const i=this.layerFor(t.blockType),r=this.heightFor(t.blockType);this.camera.drawVaried(s+"-tile",i,e.add(r).add(l.BlockCenter),null,this.variantFor(e))}layerFor(t){switch(t){case a.BlockType.Floor:return o.Layer.Floor;case a.BlockType.Half:return o.Layer.Middle;case a.BlockType.Full:return o.Layer.Top;default:throw new Error("Invalid argument: No layer for empty blocks")}}heightFor(t){switch(t){case a.BlockType.Floor:return l.FloorHeight;case a.BlockType.Half:return l.HalfHeight;case a.BlockType.Full:return l.FullHeight;default:throw new Error("Invalid argument: No layer for empty blocks")}}drawBlockWall(t,e){if(t.blockType===a.BlockType.Empty||t.blockType===a.BlockType.Floor)return;const s=this.game.config.solidTypeMap.typeFor(t.solidType);null!=s&&(t.blockType===a.BlockType.Half&&this.camera.drawVaried(s+"-wall",o.Layer.Middle-o.Layer.ZFightingAdjustment,e.add(l.BlockCenter),null,this.variantFor(e)),t.blockType===a.BlockType.Full&&this.camera.drawVaried(s+"-wall",o.Layer.Middle,e.add(l.BlockCenter),null,this.variantFor(e)))}drawTileOverlays(t,e){const s=e.add(this.camera.rightPosition),i=e.add(this.camera.bottomPosition),r=this.game.terrain.getAt(s);r&&this.drawRightLeftTileOverlay(t,e,r,s);const a=this.game.terrain.getAt(i);a&&this.drawTopBottomTileOverlay(t,e,a,i)}drawTopBottomTileOverlay(t,e,s,r){t.blockType!=s.blockType&&(t.blockType<s.blockType?this.drawTileOverlay(s,i.Top,r):t.blockType==a.BlockType.Floor&&this.drawTileOverlay(t,i.Bottom,e))}drawRightLeftTileOverlay(t,e,s,r){t.blockType!=s.blockType&&(t.blockType<s.blockType?this.drawTileOverlay(s,i.Left,r):this.drawTileOverlay(t,i.Right,e))}drawTileOverlay(t,e,s){const i=this.tileLayerFor(t.blockType),r=this.layerForSide(e),a=this.heightFor(t.blockType).add(l.BlockCenter),o=this.tileOverlayFor(t,e);this.camera.draw(o,i+r,s.add(a))}tileLayerFor(t){switch(t){case a.BlockType.Floor:return o.Layer.Floor;case a.BlockType.Half:return o.Layer.Middle;case a.BlockType.Full:default:return o.Layer.Bottom}}layerForSide(t){switch(t){case i.Bottom:return o.Layer.OverlayNorthAdjustment;case i.Top:return o.Layer.OverlaySouthAdjustment;case i.Left:return o.Layer.OverlayEastAdjustment;default:return o.Layer.OverlayWestAdjustment}}tileOverlayFor(t,e){const s="grass"==(this.game.config.solidTypeMap.typeFor(t.solidType)??"")?"grass":"default";switch(e){case i.Bottom:return s+"-tile-overlay-bottom";case i.Top:return s+"-tile-overlay-top";case i.Left:return s+"-tile-overlay-left";case i.Right:return s+"-tile-overlay-right"}}drawWallOverlays(t,e,s){const i=this.game.terrain.getAt(s);if(!i)return;const r=e.add(l.BlockCenter),n=s.add(l.BlockCenter);t.blockType==a.BlockType.Full?i.blockType==a.BlockType.Empty||i.blockType==a.BlockType.Floor?this.camera.draw(this.WallOverlayFullRightFor(t),o.Layer.Middle+o.Layer.OverlayWestAdjustment,r):i.blockType==a.BlockType.Half&&this.camera.draw(this.WallOverlayHalfRightFor(t),o.Layer.Middle+o.Layer.OverlayWestAdjustment,r.add(l.HalfHeight)):t.blockType==a.BlockType.Half?i.blockType==a.BlockType.Empty||i.blockType==a.BlockType.Floor?this.camera.draw(this.WallOverlayHalfRightFor(t),o.Layer.Middle+o.Layer.OverlayWestAdjustment,r):i.blockType==a.BlockType.Full&&this.camera.draw(this.WallOverlayHalfLeftFor(i),o.Layer.Middle+o.Layer.OverlayEastAdjustment,n.add(l.HalfHeight)):t.blockType!=a.BlockType.Floor&&t.blockType!=a.BlockType.Empty||(i.blockType==a.BlockType.Half?this.camera.draw(this.WallOverlayHalfLeftFor(i),o.Layer.Middle+o.Layer.OverlayEastAdjustment,n):i.blockType==a.BlockType.Full&&this.camera.draw(this.WallOverlayFullLeftFor(i),o.Layer.Middle+o.Layer.OverlayEastAdjustment,n))}WallOverlayFullRightFor(t){return t?"default-wall-overlay-full-right":""}WallOverlayFullLeftFor(t){return t?"default-wall-overlay-full-left":""}WallOverlayHalfRightFor(t){return t?"default-wall-overlay-half-right":""}WallOverlayHalfLeftFor(t){return t?"default-wall-overlay-half-left":""}drawWallShadows(t,e,s){const i=this.game.terrain.getAt(s);if(!i)return;const n=e.add(l.BlockCenter),c=s.add(l.BlockCenter),h=new r.Vector3(0,0,-1);t.blockType==a.BlockType.Full?i.blockType==a.BlockType.Empty&&this.game.terrain.getAt(s.add(h))?.blockType==a.BlockType.Full?this.camera.draw("default-wall-shadow-full-right",o.Layer.Bottom+o.Layer.OverlayWestAdjustment,n):i.blockType==a.BlockType.Floor?this.camera.draw("default-wall-shadow-full-right",o.Layer.Floor+o.Layer.OverlayWestAdjustment,n.add(l.FloorHeight)):i.blockType==a.BlockType.Half&&this.camera.draw("default-wall-shadow-half-right",o.Layer.Middle+o.Layer.OverlayWestAdjustment,n.add(l.HalfHeight)):t.blockType==a.BlockType.Half?i.blockType==a.BlockType.Empty&&this.game.terrain.getAt(s.add(h))?.blockType==a.BlockType.Full?this.camera.draw("default-wall-shadow-half-right",o.Layer.Bottom+o.Layer.OverlayWestAdjustment,n):i.blockType==a.BlockType.Floor?this.camera.draw("default-wall-shadow-half-right",o.Layer.Floor+o.Layer.OverlayWestAdjustment,n.add(l.FloorHeight)):i.blockType==a.BlockType.Full&&this.camera.draw("default-wall-shadow-half-left",o.Layer.Middle+o.Layer.OverlayEastAdjustment,c.add(l.HalfHeight)):t.blockType==a.BlockType.Floor?i.blockType==a.BlockType.Full?this.camera.draw("default-wall-shadow-full-left",o.Layer.Floor+o.Layer.OverlayEastAdjustment,c.add(l.FloorHeight)):i.blockType==a.BlockType.Half&&this.camera.draw("default-wall-shadow-half-left",o.Layer.Floor+o.Layer.OverlayEastAdjustment,c.add(l.FloorHeight)):t.blockType==a.BlockType.Empty&&this.game.terrain.getAt(e.add(h))?.blockType==a.BlockType.Full&&(i.blockType==a.BlockType.Full?this.camera.draw("default-wall-shadow-full-left",o.Layer.Bottom+o.Layer.OverlayEastAdjustment,c):i.blockType==a.BlockType.Half&&this.camera.draw("default-wall-shadow-half-left",o.Layer.Bottom+o.Layer.OverlayEastAdjustment,c))}variantFor(t){let e=t.x,s=t.y,i=t.z;0==e&&(e=1234),0==s&&(s=1234),0==i&&(i=1234);const r=345*(e/13+s/31+i/71);return Math.floor(1e4*(r-Math.floor(r)))}}l.BlockCenter=new r.Vector3(.5,.5,0),l.FloorHeight=new r.Vector3(0,0,1/32),l.HalfHeight=new r.Vector3(0,0,.5),l.FullHeight=new r.Vector3(0,0,1),function(t){t[t.Bottom=0]="Bottom",t[t.Top=1]="Top",t[t.Left=2]="Left",t[t.Right=3]="Right"}(i||(i={}))},"./libs/meld/src/display/world-drawer.ts":(t,e,s)=>{s.r(e),s.d(e,{WorldDrawer:()=>i});class i{constructor(t,e,s,i,r){this.game=t,this.config=e,this.camera=s,this.terrainDrawer=i,this.entityDrawer=r}drawWorld(){for(const{layer:t,area:e}of this.camera.shownLayers)this.drawLayer(t,e)}drawLayer(t,e){const s=this.entitiesInArea(t,e),i=Math.floor(e.top-this.config.wallDisplayHeight),r=Math.floor(e.bottom+this.config.wallDisplayHeight);for(let s=i;s<=r;s++)for(let i=Math.floor(e.left-1);i<=Math.floor(e.right+1);i++)this.terrainDrawer.drawBlockContent(i,s,t);for(const t of s)this.entityDrawer.draw(t)}entitiesInArea(t,e){return[...this.game.entities.with.position].filter((([,s])=>this.isInArea(t,e,s))).map((t=>t[0]))}isInArea(t,e,s){return e.left<=s.x&&s.x<e.right&&e.top<=s.y&&s.y<e.bottom&&Math.floor(s.z)==t}}},"./libs/meld/src/logic/block-collision-logic.ts":(t,e,s)=>{s.r(e),s.d(e,{BlockCollisionLogic:()=>o});var i=s("./libs/age/src/index.ts"),r=s("./libs/utility/src/index.ts"),a=s("./libs/meld/src/state/block.ts");class o{constructor(t,e,s,i,r,a,o){this.constants=t,this.entities=e,this.terrain=s,this.circularSize=i,this.position=r,this.velocity=a,this.setVelocity=o}update(){for(const[t]of this.entities.with.blockCollisionBehaviour)this.updateEntity(t)}updateEntity(t){const e=this.velocity.currentlyOf(t);if(e?.isZero()??1)return;const s=this.CollisionVelocityChange(t,e);s&&this.setVelocity.for(t,s)}CollisionVelocityChange(t,e){const s=this.position.currentlyOf(t)??new r.Vector3(0,0,0),a=this.circularSize.currentlyOf(t),o=a?i.Box.occupiedArea(s,a):i.Box.from(s),l=this.relativeDistanceToCollisionX(o,e.x),n=this.relativeDistanceToCollisionY(o,e.y),c=this.relativeDistanceToCollisionZ(o,e.z);return l>=1&&n>=1&&c>=1||(e=this.updateVelocitiesInOrder(l,n,c,o,e))==this.velocity.currentlyOf(t)?null:e}relativeDistanceToCollisionX(t,e){const s=e>0?t.maxX:t.minX;return this.relativeDistanceToCollision(s,e,1)}relativeDistanceToCollisionY(t,e){const s=e>0?t.maxY:t.minY;return this.relativeDistanceToCollision(s,e,1)}relativeDistanceToCollisionZ(t,e){const s=e>0?t.maxZ:t.minZ;return this.relativeDistanceToCollision(s,e,.5)}relativeDistanceToCollision(t,e,s){const i=t<0?s+t%s:t%s;return(e<0?i:s-i)/Math.abs(e)}updateVelocitiesInOrder(t,e,s,i,r){return t<=e&&t<=s?(r=this.updateVelocityX(t,i,r),e<=s?(r=this.updateVelocityY(e,i,r),r=this.updateVelocityZ(s,i,r)):(r=this.updateVelocityZ(s,i,r),r=this.updateVelocityY(e,i,r))):e<=t&&e<=s?(r=this.updateVelocityY(e,i,r),t<=s?(r=this.updateVelocityX(t,i,r),r=this.updateVelocityZ(s,i,r)):(r=this.updateVelocityZ(s,i,r),r=this.updateVelocityX(t,i,r))):(r=this.updateVelocityZ(s,i,r),t<=e?(r=this.updateVelocityX(t,i,r),r=this.updateVelocityY(e,i,r)):(r=this.updateVelocityY(e,i,r),r=this.updateVelocityX(t,i,r))),r}updateVelocityX(t,e,s){if(t>=1)return s;const i=e.translateBy(s.multiply(t));return this.collisionAtX(i,s.x)?s.withX(this.truncatedDistance(s.x*t)):s}updateVelocityY(t,e,s){if(t>=1)return s;const i=e.translateBy(s.multiply(t));return this.collisionAtY(i,s.y)?s.withY(this.truncatedDistance(s.y*t)):s}updateVelocityZ(t,e,s){if(t>=1)return s;const i=e.translateBy(s.multiply(t));return this.collisionAtZ(i,s.z)?s.withZ(this.truncatedDistance(s.z*t)):s}truncatedDistance(t){return t>this.constants.collisionAreaWidth?t-this.constants.collisionAreaWidth/8:t>-this.constants.collisionAreaWidth?0:t+this.constants.collisionAreaWidth/8}collisionAtX(t,e){const s=e>0?t.maxX+.5:t.minX-.5;for(const e of this.blockPositionsY(t)){if(this.isSolidAtPoint(s,e,t.minZ))return!0;for(const i of this.blockPositionAboveBottom(t))if(this.isSolidInBlock(s,e,i))return!0}return!1}collisionAtY(t,e){const s=e>0?t.maxY+.5:t.minY-.5;for(const e of this.blockPositionsX(t)){if(this.isSolidAtPoint(e,s,t.minZ))return!0;for(const i of this.blockPositionAboveBottom(t))if(this.isSolidInBlock(e,s,i))return!0}return!1}collisionAtZ(t,e){const s=e>0?t.maxZ+.5:t.minZ+this.constants.collisionAreaWidth/8;for(const i of this.blockPositionsX(t))for(const r of this.blockPositionsY(t))if(e>0?this.isSolidInBlock(i,r,s):this.isSolidGoingDown(i,r,s))return!0;return!1}isSolidGoingDown(t,e,s){const i=this.terrain.get(t,e,s)?.blockType??a.BlockType.Empty,r=s<0?1+s%1:s%1;return.5<r&&r<.5+this.constants.collisionAreaWidth?i==a.BlockType.Half:0<r&&r<this.constants.collisionAreaWidth&&(i==a.BlockType.Floor||this.terrain.get(t,e,s-1)?.blockType==a.BlockType.Full)}*blockPositionsX(t){for(let e=t.minX;e<t.maxX;e++)yield e;yield t.maxX}*blockPositionsY(t){for(let e=t.minY;e<t.maxY;e++)yield e;yield t.maxY}*blockPositionAboveBottom(t){for(let e=t.minZ+1;e<t.maxZ;e++)yield e;t.minZ<Math.floor(t.maxZ)&&(yield t.maxZ)}isSolidAtPoint(t,e,s){const i=s<0?1-s%1:s%1;switch(this.terrain.get(t,e,s)?.blockType??a.BlockType.Empty){case a.BlockType.Empty:case a.BlockType.Floor:return!1;case a.BlockType.Half:return i<.5;case a.BlockType.Full:return!0}}isSolidInBlock(t,e,s){return this.terrain.get(t,e,s)?.hasSolid()??!1}}},"./libs/meld/src/logic/gravity-logic.ts":(t,e,s)=>{s.r(e),s.d(e,{GravityLogic:()=>a});var i=s("./libs/utility/src/index.ts"),r=s("./libs/meld/src/state/block.ts");class a{constructor(t,e,s,i,r,a){this.constants=t,this.entities=e,this.terrain=s,this.position=i,this.velocity=r,this.setVelocity=a}update(){for(const[t]of this.entities.with.gravityBehaviour)this.updateEntity(t)}updateEntity(t){const e=this.position.currentlyOf(t)??new i.Vector3(0,0,0);if(this.hasGroundAt(e))return;const s=this.velocity.currentlyOf(t)??new i.Vector3(0,0,0),r=s.withZ(s.z-this.constants.gravityAcceleration);this.setVelocity.for(t,r)}hasGroundAt(t){return t.z<Math.floor(t.z)+this.constants.collisionAreaWidth?this.isInOrAboveSolidBlock(t):t.z<Math.floor(t.z)+.5+this.constants.collisionAreaWidth?this.isInHalfOrFullBlock(t):this.terrain.getAt(t)?.blockType==r.BlockType.Full}isInOrAboveSolidBlock(t){return this.terrain.getAt(t)?.blockType!=r.BlockType.Empty||this.terrain.get(t.x,t.y,t.z-1)?.blockType==r.BlockType.Full}isInHalfOrFullBlock(t){switch(this.terrain.getAt(t)?.blockType){case r.BlockType.Half:case r.BlockType.Full:return!0;default:return!1}}}},"./libs/meld/src/logic/load-state-logic.ts":(t,e,s)=>{s.r(e),s.d(e,{LoadStateLogic:()=>r});var i=s("./libs/meld/src/state/game-update.ts");class r{constructor(t){this.state=t}update(t){const e=t.find((t=>t instanceof i.LoadState));e&&this.state.loadFrom(e.state)}}},"./libs/meld/src/logic/movement-logic.ts":(t,e,s)=>{s.r(e),s.d(e,{MovementLogic:()=>a});var i=s("./libs/utility/src/index.ts"),r=s("./libs/meld/src/state/game-update.ts");class a{constructor(t,e,s){this.constants=t,this.velocity=e,this.setVelocity=s}update(t){for(const e of t)e instanceof r.MovementAction&&this.move(e.entity,e.velocity)}move(t,e){const s=e.lengthSquared()>1?e.unitVector().multiply(this.constants.maxMoveSpeed):e.multiply(this.constants.maxMoveSpeed),r=this.velocity.of(t)??new i.Vector3(0,0,0),a=new i.Vector3(s.x,s.y,r.z);this.setVelocity.for(t,a)}}},"./libs/meld/src/logic/place-block-logic.ts":(t,e,s)=>{s.r(e),s.d(e,{PlaceBlockLogic:()=>a});var i=s("./libs/meld/src/state/block.ts"),r=s("./libs/meld/src/state/game-update.ts");class a{constructor(t,e){this.terrain=t,this.selectedItem=e}update(t){for(const e of t)e instanceof r.PlaceBlockAction&&this.placeBlock(e.entity,e.position)}placeBlock(t,e){const s=this.selectedItem.of(t);if(!(s>-1))return;const r=this.terrain.getAt(e)??i.Block.newEmpty(0);r.solidType!=s||r.blockType==i.BlockType.Empty?this.terrain.setAt(e,i.Block.newFloor(s,0)):r.blockType==i.BlockType.Floor?this.terrain.setAt(e,i.Block.newHalf(s,0)):r.blockType==i.BlockType.Half?this.terrain.setAt(e,i.Block.newFull(s)):r.blockType==i.BlockType.Full&&this.terrain.setAt(e,i.Block.newFloor(s,0))}}},"./libs/meld/src/logic/selected-item-logic.ts":(t,e,s)=>{s.r(e),s.d(e,{SelectedItemLogic:()=>r});var i=s("./libs/meld/src/state/game-update.ts");class r{constructor(t,e,s){this.config=t,this.selectedBlock=e,this.setSelectedBlock=s}update(t){for(const e of t)e instanceof i.SelectNextItemAction&&this.incrementSelectedItemFor(e.entity)}incrementSelectedItemFor(t){const e=[...this.config.solidTypeMap.types.values()],s=this.selectedBlock.of(t),i=e.indexOf(s),r=i+1<e.length?i+1:0;this.setSelectedBlock.for(t,e[r])}}},"./libs/meld/src/logic/start-logic.ts":(t,e,s)=>{s.r(e),s.d(e,{StartLogic:()=>o});var i=s("./libs/utility/src/index.ts"),r=s("./libs/meld/src/state/block.ts"),a=s("./libs/meld/src/state/game-update.ts");class o{constructor(t,e,s,i,r,a,o){this.config=t,this.state=e,this.changes=s,this.entities=i,this.terrain=r,this.setPosition=a,this.random=o}update(t){t.some((t=>t instanceof a.GenerateAction))&&this.initialiseGame()}initialiseGame(){this.generateRandomTerrain(),this.clearEntities(),this.spawnPlayer()}generateRandomTerrain(){const t=[...this.config.solidTypeMap.types.values()];this.terrain.addChunk(0,0,0),this.terrain.addChunk(0,-1,0),this.terrain.addChunk(-1,0,0),this.terrain.addChunk(-1,-1,0);for(const{position:e}of this.terrain.allFields())0===e.z&&(Math.random()<.9?this.terrain.set(r.Block.newFloor(this.random.get.in(t),0),e.x,e.y,e.z):this.terrain.set(r.Block.newFull(this.random.get.in(t)),e.x,e.y,e.z))}clearEntities(){for(const[t,e]of this.changes.updatedEntityValues.entities)e&&this.entities.remove(t);this.entities.remove(...this.entities),this.state.players.clear()}spawnPlayer(){const t=this.entities.create(this.config.constants.playerType);this.setPosition.for(t,new i.Vector3(5,5,0)),this.state.players.set("insertPlayerName",t)}}},"./libs/meld/src/logic/update-state-logic.ts":(t,e,s)=>{s.r(e),s.d(e,{UpdateStateLogic:()=>i});class i{constructor(t,e,s){this.state=t,this.entities=e,this.terrain=s}update(){this.state.globals.tick++,this.entities.applyUpdatedValues(),this.terrain.applyUpdatedValues()}}},"./libs/meld/src/logic/velocity-logic.ts":(t,e,s)=>{s.r(e),s.d(e,{VelocityLogic:()=>r});var i=s("./libs/utility/src/index.ts");class r{constructor(t,e,s,i,r,a){this.constants=t,this.entities=e,this.position=s,this.setPosition=i,this.velocity=r,this.setVelocity=a}update(){for(const[t,e]of this.entities.with.velocity)this.updateEntity(t)}updateEntity(t){const e=this.velocity.currentlyOf(t);if(!e||e.isZero())return;const s=this.cappedVelocity(e),i=this.position.currentlyOf(t);this.setPosition.for(t,i.add(s)),this.setVelocity.for(t,s)}cappedVelocity(t){return this.constants.terminalVerticalVelocity>=Math.abs(t.z)?t:new i.Vector3(t.x,t.y,t.z=Math.sign(t.z)*this.constants.terminalVerticalVelocity)}}},"./libs/meld/src/meld-display.ts":(t,e,s)=>{s.r(e),s.d(e,{MeldDisplay:()=>h});var i=s("./libs/meld/src/display/camera.ts"),r=s("./libs/meld/src/display/display-state.ts"),a=s("./libs/meld/src/display/entity-drawer.ts"),o=s("./libs/meld/src/display/hud-drawer.ts"),l=s("./libs/meld/src/display/input-parser.ts"),n=s("./libs/meld/src/display/terrain-drawer.ts"),c=s("./libs/meld/src/display/world-drawer.ts");class h{constructor(t,e,s,h,d=r.DisplayState.from(t,h),u=new i.Camera(e,s,t,d),y=new l.InputParser(e,d,u,s,t.inputs),p=new n.TerrainDrawer(e,t,u),g=new a.EntityDrawer(e,u),m=new c.WorldDrawer(e,t,u,p,g),f=new o.HudDrawer(e,d,s)){this.config=t,this.game=e,this.display=s,this.state=d,this.camera=u,this.inputParser=y,this.terrainDrawer=p,this.entityDrawer=g,this.worldDrawer=m,this.hudDrawer=f,s.sortByDepth=!0}setSize(t,e){this.state.size.updateHostSize(t,e)}show(t=0){this.state.fractionOfTick=t;const e=[...this.game.entities.with.position.keys()][0];this.camera.focusOn(e),this.display.startFrame(),this.worldDrawer.drawWorld(),this.hudDrawer.draw(),this.display.endFrame()}getNewActions(){return this.inputParser.parseInputs()}}},"./libs/meld/src/meld-game.ts":(t,e,s)=>{var i,r;s.r(e),s.d(e,{MeldGame:()=>g,updatesPerSecond:()=>p});var a=s("./libs/age/src/index.ts"),o=s("./libs/meld/src/display-config.json"),l=s("./libs/meld/src/game-config.json"),n=s("./libs/meld/src/meld.ts"),c=s("./libs/meld/src/meld-display.ts"),h=s("./libs/meld/src/serialisation/serialisation-display-config.ts"),d=s("./libs/meld/src/serialisation/serialisation-game-config.ts"),u=s("./libs/meld/src/serialisation/serialisation-game-state.ts"),y=s("./libs/meld/src/state/game-update.ts");const p=30;class g extends a.GameRunner{constructor(t,e,s,i,r=new ResizeObserver((()=>this.setSize(t.clientWidth,t.clientHeight)))){super(e,i,p),this.meldDisplay=e,this.displayProvider=s,this.meld=i,this.resizeObserver=r,this.onUnload=()=>{this.saveGame()},this.resizeObserver.observe(t);const a=localStorage["meld-save"];a?this.actions.push(new y.LoadState((0,u.readGameState)(JSON.parse(a)))):this.actions.push(new y.GenerateAction),window.addEventListener("unload",this.onUnload)}saveGame(){const t=(0,u.createGameState)(this.meld.config,this.meld.state);localStorage["meld-save"]=JSON.stringify(t)}static createAt(t,e){e={...(0,h.readDisplayConfig)(i||(i=s.t(o,2))),...e};const u=new n.Meld((0,d.readGameConfig)(r||(r=s.t(l,2)))),y=new a.HtmlDisplayProvider(t,e),p=new c.MeldDisplay(e,u,y,"insertPlayerName");return new g(t,p,y,u)}setSize(t,e){this.meldDisplay.setSize(t,e),this.displayProvider.setSize(t,e)}onDestroy(){this.resizeObserver.disconnect(),window.removeEventListener("visibilitychanged",this.onUnload),this.saveGame()}}},"./libs/meld/src/meld.ts":(t,e,s)=>{s.r(e),s.d(e,{Meld:()=>w});var i=s("./libs/age/src/index.ts"),r=s("./libs/meld/src/logic/movement-logic.ts"),a=s("./libs/meld/src/logic/place-block-logic.ts"),o=s("./libs/meld/src/logic/selected-item-logic.ts"),l=s("./libs/meld/src/logic/start-logic.ts"),n=s("./libs/meld/src/logic/update-state-logic.ts"),c=s("./libs/meld/src/logic/velocity-logic.ts"),h=s("./libs/meld/src/state/entity-values.ts"),d=s("./libs/meld/src/state/globals.ts"),u=s("./libs/meld/src/state/changes.ts"),y=s("./libs/meld/src/state/meld-entities.ts"),p=s("./libs/meld/src/state/game-state.ts"),g=s("./libs/meld/src/logic/load-state-logic.ts"),m=s("./libs/meld/src/logic/block-collision-logic.ts"),f=s("./libs/meld/src/logic/gravity-logic.ts");class w extends i.BaseGame{constructor(t,e=new p.GameState(new d.Globals,new h.EntityValues),s=new u.Changes(new h.EntityValues),w=new i.TerrainManager(t.constants.chunkSize,e.chunks,s.updatedBlocks),b=new y.MeldEntities(t.entityTypeValues,e.entityValues,s.updatedEntityValues,e),v=new i.Random((()=>e.globals.seed+e.globals.tick)),x=new m.BlockCollisionLogic(t.constants,b,w,b.circularSize.get,b.position.get,b.velocity.get,b.velocity.set),S=new f.GravityLogic(t.constants,b,w,b.position.get,b.velocity.get,b.velocity.set),k=new g.LoadStateLogic(e),T=new r.MovementLogic(t.constants,b.velocity.get,b.velocity.set),B=new a.PlaceBlockLogic(w,b.selectedBlock.get),M=new o.SelectedItemLogic(t,b.selectedBlock.get,b.selectedBlock.set),P=new l.StartLogic(t,e,s,b,w,b.position.set,v),A=new n.UpdateStateLogic(e,b,w),F=new c.VelocityLogic(t.constants,b,b.position.get,b.position.set,b.velocity.get,b.velocity.set)){super([T,S,x,F,B,M,P,A,k]),this.config=t,this.state=e,this.changes=s,this.terrain=w,this.entities=b,this.random=v,this.blockCollisionLogic=x,this.gravityLogic=S,this.loadStateLogic=k,this.movementLogic=T,this.placeBlockLogic=B,this.selectedItemLogic=M,this.startLogic=P,this.updateStateLogic=A,this.velocityLogic=F}}},"./libs/meld/src/serialisation/serialisation-display-config.ts":(t,e,s)=>{s.r(e),s.d(e,{readDisplayConfig:()=>a});var i=s("./libs/meld/src/display/input-parser.ts"),r=s("./libs/meld/src/meld-game.ts");function a(t){const e={...t},s=new Map;for(const e in t.inputs)s.set(i.Input[e],t.inputs[e]);const r={};for(const t in e.sprites)r[t]=o(e.sprites[t]);return{renderToVirtualSize:!0,virtualPixelsPerTile:16,virtualHeight:360,wallDisplayHeight:2,displayDepth:4,...e,inputs:s,sprites:r}}function o(t){const e=t.framesX??1,s=t.framesY??1,i=t.frameWeights??[1];for(;i.length<e*s;)i.push(1);return{path:t.path,width:t.width??16,height:t.height??16,centerX:t.centerX??0,centerY:t.centerY??0,framesX:e,framesY:s,frameInterval:Math.floor(t.frameInterval*r.updatesPerSecond)??0,frameWeights:i}}},"./libs/meld/src/serialisation/serialisation-game-config.ts":(t,e,s)=>{s.r(e),s.d(e,{readGameConfig:()=>n});var i=s("./libs/age/src/index.ts"),r=s("./libs/utility/src/index.ts"),a=s("./libs/meld/src/config/constants.ts"),o=s("./libs/meld/src/config/game-config.ts"),l=s("./libs/meld/src/meld-game.ts");function n(t){const e=Object.keys(t.entityTypes),s=i.TypeMap.from(e),n=Object.keys(t.solidTypes),h=i.TypeMap.from(n),d=Object.keys(t.nonSolidTypes),u=i.TypeMap.from(d);return new o.GameConfig(function(t,e){const s=Object.assign(new a.Constants(0),t);return s.playerType=e.typeIdFor(t.playerType),t.chunkSize&&(s.chunkSize=new r.Vector3(t.chunkSize.x,t.chunkSize.y,t.chunkSize.z)),s.gravityAcceleration=(t.gravityAcceleration??.5)/l.updatesPerSecond,s.terminalVerticalVelocity=(t.terminalVerticalVelocity??10)/l.updatesPerSecond,s.maxMoveSpeed=(t.maxMoveSpeed??10)/l.updatesPerSecond,s}(t.constants,s),s,new Map(e.map((e=>[s.typeIdFor(e),c(t.entityTypes[e],h)]))),h,new Map(n.map((t=>[h.typeIdFor(t),{hardness:0}]))),u,new Map(d.map((t=>[u.typeIdFor(t),{hardness:0}]))))}function c(t,e){const s={...t};return t.position&&(s.position=Object.assign(new r.Vector3(0,0,0),t.position)),t.circularSize&&(s.circularSize=Object.assign(new i.CircularSize(0,0),t.circularSize)),t.selectedBlock&&(s.selectedBlock=e.typeIdFor(t.selectedBlock)),t.velocity&&(s.velocity=Object.assign(new r.Vector3(0,0,0),t.velocity)),s}},"./libs/meld/src/serialisation/serialisation-game-state.ts":(t,e,s)=>{s.r(e),s.d(e,{createGameState:()=>n,readGameState:()=>c});var i=s("./libs/age/src/index.ts"),r=s("./libs/utility/src/index.ts"),a=s("./libs/meld/src/state/block.ts"),o=s("./libs/meld/src/state/entity-values.ts"),l=s("./libs/meld/src/state/game-state.ts");function n(t,e){return function(t,e=null){const s=[];for(const[e,i]of t.chunks)s.push(d(i,r.Vector3.parse(e)));const a={};for(const[e]of t.entityValues.entities)a[e]=t.entityValues.groupFor(e);return{entityTypeMap:e?.entityTypeMap??new i.TypeMap,solidTypeMap:e?.solidTypeMap??new i.TypeMap,nonSolidTypeMap:e?.nonSolidTypeMap??new i.TypeMap,globals:t.globals,entityValues:a,chunks:s,players:Object.fromEntries(t.players.entries())}}(e,t)}function c(t){return function(t){const e=new o.EntityValues;for(const s in t.entityValues)e.addValuesFrom(+s,u(t.entityValues[s]));const s=new Map;for(const e of t.chunks)s.set(r.Vector3.stringify(e.coords.x,e.coords.y,e.coords.z),h(e));const i=new Map;for(const e in t.players)i.set(e,t.players[e]);return new l.GameState(t.globals,e,s,i)}(t)}function h(t){const e=t.blocks.map((t=>a.Block.deserialise(t)));return new i.BlockChunk(e,new r.Vector3(t.size.x,t.size.y,t.size.z),new r.Vector3(t.size.x*t.coords.x,t.size.y*t.coords.y,t.size.z*t.coords.z))}function d(t,e){const s=t.blocks.map((t=>t.serialise()));return{size:t.chunkSize,coords:e,blocks:s}}function u(t){const e={...t};return t.position&&(e.position=Object.assign(new r.Vector3(0,0,0),t.position)),t.circularSize&&(e.circularSize=Object.assign(new i.CircularSize(0,0),t.circularSize)),t.velocity&&(e.velocity=Object.assign(new r.Vector3(0,0,0),t.velocity)),e}},"./libs/meld/src/state/block.ts":(t,e,s)=>{s.r(e),s.d(e,{Block:()=>i,BlockType:()=>r});class i{constructor(t,e,s){this.blockType=t,this.solidType=e,this.nonSolidType=s}static newEmpty(t){return new i(r.Empty,0,t)}static newFloor(t,e){return new i(r.Floor,t,e)}static newHalf(t,e){return new i(r.Half,t,e)}static newFull(t){return new i(r.Full,t,0)}hasSolid(){switch(this.blockType){case r.Floor:case r.Half:case r.Full:return!0;default:return!1}}hasNonSolid(){switch(this.blockType){case r.Empty:case r.Floor:case r.Half:return!0;default:return!1}}serialise(){return this.solidType|this.nonSolidType|this.blockType.valueOf()<<28}static deserialise(t){return new i((4026531840&t)>>28,268435455&t,268369920&t)}}var r;!function(t){t[t.Empty=0]="Empty",t[t.Floor=1]="Floor",t[t.Half=2]="Half",t[t.Full=3]="Full"}(r||(r={}))},"./libs/meld/src/state/changes.ts":(t,e,s)=>{s.r(e),s.d(e,{Changes:()=>i});class i{constructor(t,e=new Map){this.updatedEntityValues=t,this.updatedBlocks=e}}},"./libs/meld/src/state/entity-values.ts":(t,e,s)=>{s.r(e),s.d(e,{EntityValues:()=>r});var i=s("./libs/age/src/index.ts");class r extends i.BaseValues{constructor(t=new Map,e=new Map,s=new Map,i=new Map,r=new Map,a=new Map,o=new Map,l=new Map,n=new Map){super(n),this.health=t,this.orientation=e,this.position=s,this.circularSize=i,this.selectedBlock=r,this.velocity=a,this.blockCollisionBehaviour=o,this.gravityBehaviour=l,this.register(t),this.register(e),this.register(s),this.register(i),this.register(r),this.register(a),this.register(o),this.register(l)}static from(t){const e=new r;for(const[s,i]of t)e.addValuesFrom(s,i);return e}addValuesFrom(t,e){this.entities.set(t,!0),void 0!==e.health&&this.health.set(t,e.health),void 0!==e.orientation&&this.orientation.set(t,e.orientation),void 0!==e.position&&this.position.set(t,e.position),void 0!==e.circularSize&&this.circularSize.set(t,e.circularSize),void 0!==e.selectedBlock&&this.selectedBlock.set(t,e.selectedBlock),void 0!==e.velocity&&this.velocity.set(t,e.velocity),void 0!==e.blockCollisionBehaviour&&this.blockCollisionBehaviour.set(t,e.blockCollisionBehaviour),void 0!==e.gravityBehaviour&&this.gravityBehaviour.set(t,e.gravityBehaviour)}groupFor(t){return{health:this.health.get(t),orientation:this.orientation.get(t),position:this.position.get(t),circularSize:this.circularSize.get(t),selectedBlock:this.selectedBlock.get(t),velocity:this.velocity.get(t),blockCollisionBehaviour:this.blockCollisionBehaviour.get(t),gravityBehaviour:this.gravityBehaviour.get(t)}}}},"./libs/meld/src/state/game-state.ts":(t,e,s)=>{s.r(e),s.d(e,{GameState:()=>i});class i{constructor(t,e,s=new Map,i=new Map){this.globals=t,this.entityValues=e,this.chunks=s,this.players=i}getNewId(){return this.globals.nextId++}loadFrom(t){this.globals.tick=t.globals.tick,this.globals.seed=t.globals.seed,this.globals.nextId=t.globals.nextId,this.entityValues.clearValues(),this.entityValues.entities.clear();for(const[e,s]of t.entityValues.entities)this.entityValues.entities.set(e,s);this.entityValues.addValuesFromOther(t.entityValues),this.chunks.clear();for(const[e,s]of t.chunks)this.chunks.set(e,s);this.players.clear();for(const[e,s]of t.players)this.players.set(e,s)}}},"./libs/meld/src/state/game-update.ts":(t,e,s)=>{s.r(e),s.d(e,{GameUpdate:()=>i,GenerateAction:()=>r,LoadState:()=>a,MovementAction:()=>o,PlaceBlockAction:()=>l,SelectNextItemAction:()=>n});class i{}class r extends i{}class a extends i{constructor(t){super(),this.state=t}}class o extends i{constructor(t,e){super(),this.entity=t,this.velocity=e}}class l extends i{constructor(t,e){super(),this.entity=t,this.position=e}}class n extends i{constructor(t){super(),this.entity=t}}},"./libs/meld/src/state/globals.ts":(t,e,s)=>{s.r(e),s.d(e,{Globals:()=>i});class i{constructor(t=0,e=1,s=1){this.tick=t,this.nextId=e,this.seed=s}}},"./libs/meld/src/state/meld-entities.ts":(t,e,s)=>{s.r(e),s.d(e,{MeldEntities:()=>r});var i=s("./libs/age/src/index.ts");class r extends i.EntityManager{constructor(t,e,s,r,a=new i.ValueAccessBuilder(t,e,s),o=a.for((t=>t.health),(t=>t.health)),l=a.for((t=>t.orientation),(t=>t.orientation),0),n=a.for((t=>t.position),(t=>t.position)),c=a.for((t=>t.circularSize),(t=>t.circularSize)),h=a.for((t=>t.selectedBlock),(t=>t.selectedBlock)),d=a.for((t=>t.velocity),(t=>t.velocity)),u=a.for((t=>t.blockCollisionBehaviour),(t=>t.blockCollisionBehaviour)),y=a.for((t=>t.gravityBehaviour),(t=>t.gravityBehaviour))){super(e,s,r),this.health=o,this.orientation=l,this.position=n,this.circularSize=c,this.selectedBlock=h,this.velocity=d,this.blockCollisionBehaviour=u,this.gravityBehaviour=y,this.valueAccessors.push(o,l,n,c,h,d,u,y)}}},"./libs/utility/src/array-extensions.ts":(t,e,s)=>{s.r(e),Object.defineProperty(Array.prototype,"sum",{value:function(){return this.reduce(((t,e)=>t+ +e),0)}}),Object.defineProperty(Array.prototype,"max",{value:function(){if(!this.length)throw new Error("Cannot find the max value in an empty array");return this.reduce(((t,e)=>t>e?t:e))}}),Object.defineProperty(Array.prototype,"min",{value:function(){if(!this.length)throw new Error("Cannot find the min value in an empty array");return this.reduce(((t,e)=>t<e?t:e))}}),Object.defineProperty(Array.prototype,"clear",{value:function(){return this.splice(0,this.length)}}),Object.defineProperty(Array.prototype,"first",{value:function(){return this[0]}}),Object.defineProperty(Array.prototype,"last",{value:function(){return this[this.length-1]}}),Object.defineProperty(Array.prototype,"distinct",{value:function(){return this.filter(((t,e)=>this.indexOf(t)===e))}}),Object.defineProperty(Array.prototype,"distinctBy",{value:function(t){return this.filter(((e,s)=>{const i=t(e);return this.findIndex((e=>t(e)===i))===s}))}}),Object.defineProperty(Array.prototype,"sortBy",{value:function(t,e=!0){return this.sort(((s,i)=>{let r=t(s);"string"==typeof r&&(r=r.toLowerCase());let a=t(i);return"string"==typeof a&&(a=a.toLowerCase()),r>a?e?1:-1:r<a?e?-1:1:0}))}}),Object.defineProperty(Array.prototype,"includesAny",{value:function(t){return this.some((e=>t.includes(e)))}}),Object.defineProperty(Array.prototype,"groupBy",{value:function(t){const e=[];for(const s of this){const i=t(s);let r=e.find((t=>t.group===i));r||(r={group:i,entries:[]},e.push(r)),r.entries.push(s)}return e}}),Object.defineProperty(Array.prototype,"remove",{value:function(t){const e=this.indexOf(t);return e>=0&&(this.splice(e,1),!0)}}),Object.defineProperty(Array.prototype,"findAndRemove",{value:function(t){const e=this.findIndex(t);return e>=0&&(this.splice(e,1),!0)}}),Object.defineProperty(Array.prototype,"removeBy",{value:function(t){const e=[];for(let s=0;s<this.length;s++)t(this[s])&&(e.push(...this.splice(s,1)),s--);return e}})},"./libs/utility/src/index.ts":(t,e,s)=>{s.r(e),s.d(e,{KeyStates:()=>i.KeyStates,Vector2:()=>a.Vector2,Vector3:()=>o.Vector3,clip:()=>r.clip,hexEastOf:()=>r.hexEastOf,hexNorthEastOf:()=>r.hexNorthEastOf,hexNorthWestOf:()=>r.hexNorthWestOf,hexSouthEastOf:()=>r.hexSouthEastOf,hexSouthWestOf:()=>r.hexSouthWestOf,hexWestOf:()=>r.hexWestOf,hexesAdjacentTo:()=>r.hexesAdjacentTo,randomInt:()=>r.randomInt,randomIntBelow:()=>r.randomIntBelow,randomNumber:()=>r.randomNumber,randomNumberBelow:()=>r.randomNumberBelow,range:()=>r.range}),s("./libs/utility/src/array-extensions.ts");var i=s("./libs/utility/src/key-states.ts"),r=s("./libs/utility/src/utility.ts"),a=s("./libs/utility/src/vector2.ts"),o=s("./libs/utility/src/vector3.ts")},"./libs/utility/src/key-states.ts":(t,e,s)=>{s.r(e),s.d(e,{KeyStates:()=>i});class i{constructor(t={},e={},s={}){this.onDown=t,this.onUp=e,this.states=s,this.onKeyDown=t=>{this.states[t.code]||(this.states[t.code]=1,this.onDown[t.code]?.(t.code))},this.onKeyUp=t=>{this.states[t.code]&&(this.states[t.code]=0,this.onUp[t.code]?.(t.code))},this.onMouseMove=t=>{this.states.MouseX=t.clientX,this.states.MouseY=t.clientY},this.onMouseDown=t=>{const e=this.getMouseButtonCode(t);this.states[e]||(this.states[e]=1,this.onDown[e]?.(e))},this.onMouseUp=t=>{const e=this.getMouseButtonCode(t);this.states[e]&&(this.states[e]=0,this.onUp[e]?.(e))},window.addEventListener("keydown",this.onKeyDown,{capture:!0}),window.addEventListener("keyup",this.onKeyUp),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mousedown",this.onMouseDown),window.addEventListener("mouseup",this.onMouseUp)}onDestroy(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mouseup",this.onMouseUp)}getMouseButtonCode(t){switch(t.button){case 0:return"MouseLeft";case 1:return"MouseMiddle";case 2:return"MouseRight"}}getInputState(t){return this.states[t]??this.getFirstGamepadState(t)}getFirstGamepadState(t){const e=(navigator.getGamepads?.()??[]).filter((t=>t));if(0===e.length)return 0;const s=e.first();return"standard"===s?.mapping?this.getStandardGamepadState(t,s):this.getNonStandardGamepadState(t,s)}getStandardGamepadState(t,e){return this.getStandardButtonState(t,e)??this.getStandardAnalogStickState(t,e)}getStandardButtonState(t,e){switch(t){case"PadA":return e.buttons[0].pressed?1:0;case"PadB":return e.buttons[1].pressed?1:0;case"PadX":return e.buttons[2].pressed?1:0;case"PadY":return e.buttons[3].pressed?1:0;case"PadLeftShoulder":return e.buttons[4].pressed?1:0;case"PadRightShoulder":return e.buttons[5].pressed?1:0;case"PadSelect":return e.buttons[8].pressed?1:0;case"PadStart":return e.buttons[9].pressed?1:0;case"PadUp":return e.buttons[12].pressed?1:0;case"PadDown":return e.buttons[13].pressed?1:0;case"PadLeft":return e.buttons[14].pressed?1:0;case"PadRight":return e.buttons[15].pressed?1:0}}getStandardAnalogStickState(t,e){switch(t){case"PadLeftStickUp":return 1.2*Math.max(0,-e.axes[1])-.2;case"PadLeftStickDown":return 1.2*Math.max(0,e.axes[1])-.2;case"PadLeftStickLeft":return 1.2*Math.max(0,-e.axes[0])-.2;case"PadLeftStickRight":return 1.2*Math.max(0,e.axes[0])-.2}}getNonStandardGamepadState(t,e){return this.getNonStandardDpadState(t,e)??this.getStandardButtonState(t,e)??this.getNonStandardEmulatedLeftAnalogState(t,e)}getNonStandardDpadState(t,e){switch(t){case"PadUp":return e.axes[9]<-.7||.8<e.axes[9]&&e.axes[9]<1.1?1:0;case"PadDown":return-.2<e.axes[9]&&e.axes[9]<.5?1:0;case"PadLeft":return.4<e.axes[9]&&e.axes[9]<1.1?1:0;case"PadRight":return-.8<e.axes[9]&&e.axes[9]<0?1:0}}getNonStandardEmulatedLeftAnalogState(t,e){switch(t){case"PadLeftStickUp":return e.axes[9]<-.7||.8<e.axes[9]&&e.axes[9]<1.1?1:0;case"PadLeftStickDown":return-.2<e.axes[9]&&e.axes[9]<.5?1:0;case"PadLeftStickLeft":return.4<e.axes[9]&&e.axes[9]<1.1?1:0;case"PadLeftStickRight":return-.8<e.axes[9]&&e.axes[9]<0?1:0}}}},"./libs/utility/src/utility.ts":(t,e,s)=>{function*i(t,e){for(let s=t;s<e;s++)yield s}function r(t,e,s,i=!1){if(s<=e)throw"Error";if(!i)return t<e?t=e:s<=t&&(t=s),t;for(;t<e;)t+=s-e;for(;s<=t;)t-=s-e;return t}function a(t,e){return[o(t,e),l(t,e),n(t,e),c(t,e),h(t,e),d(t,e)]}function o(t,e,s=1){const i=(e+s)%2==0?-1:0;return{x:t-Math.floor(s/2)+i,y:e-s}}function l(t,e,s=1){const i=(e+s)%2==0?0:1;return{x:t+Math.floor(s/2)+i,y:e-s}}function n(t,e,s=1){return{x:t-s,y:e}}function c(t,e,s=1){return{x:t+s,y:e}}function h(t,e,s=1){const i=(e+s)%2==0?-1:0;return{x:t-Math.floor(s/2)+i,y:e+s}}function d(t,e,s=1){const i=(e+s)%2==0?0:1;return{x:t+Math.floor(s/2)+i,y:e+s}}function u(t,e){return Math.floor(Math.random()*(e-t)+t)}function y(t){return Math.floor(Math.random()*t)}function p(t,e){return Math.random()*(e-t)+t}function g(t){return Math.random()*t}s.r(e),s.d(e,{clip:()=>r,hexEastOf:()=>c,hexNorthEastOf:()=>l,hexNorthWestOf:()=>o,hexSouthEastOf:()=>d,hexSouthWestOf:()=>h,hexWestOf:()=>n,hexesAdjacentTo:()=>a,randomInt:()=>u,randomIntBelow:()=>y,randomNumber:()=>p,randomNumberBelow:()=>g,range:()=>i})},"./libs/utility/src/vector2.ts":(t,e,s)=>{s.r(e),s.d(e,{Vector2:()=>r});var i=s("./libs/utility/src/utility.ts");class r{constructor(t,e){this.x=t,this.y=e}static fromAngle(t){return new r(1,0).rotate(t)}add(t){return new r(this.x+t.x,this.y+t.y)}subtract(t){return new r(this.x-t.x,this.y-t.y)}multiply(t){return new r(this.x*t,this.y*t)}rotate(t){return new r(this.x*Math.cos(t)-this.y*Math.sin(t),this.x*Math.sin(t)+this.y*Math.cos(t))}angle(){return Math.atan2(this.y,this.x)}lengthSquared(){return this.x*this.x+this.y*this.y}unitVector(){const t=this.length();return 0===t?new r(0,0):new r(this.x/t,this.y/t)}length(){return 0===this.x||0===this.y?this.x+this.y:Math.sqrt(this.lengthSquared())}copy(){return new r(this.x,this.y)}clip(t,e,s,a,o=!1){return new r((0,i.clip)(this.x,t,s,o),(0,i.clip)(this.y,e,a,o))}set(t,e){this.x=t,this.y=e}isZero(){return 0===this.x&&0===this.y}}},"./libs/utility/src/vector3.ts":(t,e,s)=>{s.r(e),s.d(e,{Vector3:()=>i});class i{constructor(t,e,s){this.x=t,this.y=e,this.z=s}add(t){return new i(this.x+t.x,this.y+t.y,this.z+t.z)}subtract(t){return new i(this.x-t.x,this.y-t.y,this.z-t.z)}multiply(t){return new i(this.x*t,this.y*t,this.z*t)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z}unitVector(){const t=this.length();return 0===t?new i(0,0,0):new i(this.x/t,this.y/t,this.z/t)}length(){return 0===this.x||0===this.y?this.x+this.y:Math.sqrt(this.lengthSquared())}isZero(){return 0===this.x&&0===this.y&&0===this.z}static copy(t){return new i(t.x,t.y,t.z)}stringify(){return this.x+","+this.y+","+this.z}static parse(t){const[e,s,r]=t.split(",");return new i(+e,+s,+r)}static stringify(t,e,s){return t+","+e+","+s}withX(t){return new i(t,this.y,this.z)}withY(t){return new i(this.x,t,this.z)}withZ(t){return new i(this.x,this.y,t)}}},"./libs/web-gl-display/src/generic-shader.ts":(t,e,s)=>{s.r(e),s.d(e,{GenericShader:()=>i});class i{constructor(t,e,s){this.gl=t;const i=this.getShader(e,t.VERTEX_SHADER),r=this.getShader(s,t.FRAGMENT_SHADER);this.program=this.createProgram(i,r),t.deleteShader(i),t.deleteShader(r)}getShader(t,e){const s=this.gl.createShader(e);if(this.gl.shaderSource(s,t),this.gl.compileShader(s),!this.gl.getShaderParameter(s,this.gl.COMPILE_STATUS))throw new Error("Shader error: "+this.gl.getShaderInfoLog(s));return s}createProgram(t,e){const s=this.gl.createProgram();if(this.gl.attachShader(s,t),this.gl.attachShader(s,e),this.gl.linkProgram(s),!this.gl.getProgramParameter(s,this.gl.LINK_STATUS))throw new Error("Shader program error: "+this.gl.getProgramInfoLog(s));return this.gl.detachShader(s,t),this.gl.detachShader(s,e),this.gl.useProgram(null),s}}},"./libs/web-gl-display/src/index.ts":(t,e,s)=>{s.r(e),s.d(e,{WebGl2Display:()=>i.WebGl2Display});var i=s("./libs/web-gl-display/src/web-gl-display.ts")},"./libs/web-gl-display/src/m3x3.ts":(t,e,s)=>{s.r(e),s.d(e,{M3x3:()=>i});class i{constructor(t=[1,0,0,0,1,0,0,0,1]){this.matrix=t}multiply(t){const e=new i;return e.matrix=[this.matrix[0]*t.matrix[0]+this.matrix[3]*t.matrix[1]+this.matrix[6]*t.matrix[2],this.matrix[1]*t.matrix[0]+this.matrix[4]*t.matrix[1]+this.matrix[7]*t.matrix[2],this.matrix[2]*t.matrix[0]+this.matrix[5]*t.matrix[1]+this.matrix[8]*t.matrix[2],this.matrix[0]*t.matrix[3]+this.matrix[3]*t.matrix[4]+this.matrix[6]*t.matrix[5],this.matrix[1]*t.matrix[3]+this.matrix[4]*t.matrix[4]+this.matrix[7]*t.matrix[5],this.matrix[2]*t.matrix[3]+this.matrix[5]*t.matrix[4]+this.matrix[8]*t.matrix[5],this.matrix[0]*t.matrix[6]+this.matrix[3]*t.matrix[7]+this.matrix[6]*t.matrix[8],this.matrix[1]*t.matrix[6]+this.matrix[4]*t.matrix[7]+this.matrix[7]*t.matrix[8],this.matrix[2]*t.matrix[6]+this.matrix[5]*t.matrix[7]+this.matrix[8]*t.matrix[8]],e}transition(t,e){const s=new i;return s.matrix=[this.matrix[0],this.matrix[1],this.matrix[2],this.matrix[3],this.matrix[4],this.matrix[5],t*this.matrix[0]+e*this.matrix[3]+this.matrix[6],t*this.matrix[1]+e*this.matrix[4]+this.matrix[7],t*this.matrix[2]+e*this.matrix[5]+this.matrix[8]],s}scale(t,e){const s=new i;return s.matrix=[this.matrix[0]*t,this.matrix[1]*t,this.matrix[2]*t,this.matrix[3]*e,this.matrix[4]*e,this.matrix[5]*e,this.matrix[6],this.matrix[7],this.matrix[8]],s}getFloatArray(){return new Float32Array(this.matrix)}}},"./libs/web-gl-display/src/sprite-factory.ts":(t,e,s)=>{s.r(e),s.d(e,{SpriteFactory:()=>r});var i=s("./libs/web-gl-display/src/sprite.ts");class r{constructor(t,e,s,i){this.gl=t,this.shader=e,this.tileSize=s,this.worldSpaceMatrix=i}async createSprite(t,e,s,r,a){const o=await this.loadImage(t),l=e/o.width,n=s/o.height;this.gl.useProgram(this.shader.program);const c=this.createTexture(o),h=this.createTextureBuffer(l,n),d=this.createGeometryBuffer(e,s);return this.gl.useProgram(null),new i.Sprite(this.gl,this.shader,this.tileSize,this.worldSpaceMatrix,c,h,d,r,a,l,n)}loadImage(t){return new Promise((e=>{const s=new Image;s.onload=()=>e(s),s.src=t}))}createTexture(t){const e=this.gl,s=e.createTexture();return e.bindTexture(e.TEXTURE_2D,s),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.MIRRORED_REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.MIRRORED_REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.bindTexture(e.TEXTURE_2D,null),s}createTextureBuffer(t,e){const s=this.gl,i=s.createBuffer();return s.bindBuffer(s.ARRAY_BUFFER,i),s.bufferData(s.ARRAY_BUFFER,this.createRectArray(0,0,t,e),s.STATIC_DRAW),i}createGeometryBuffer(t,e){const s=this.gl,i=s.createBuffer();return s.bindBuffer(s.ARRAY_BUFFER,i),s.bufferData(s.ARRAY_BUFFER,this.createRectArray(0,0,t,e),s.STATIC_DRAW),i}createRectArray(t=0,e=0,s=1,i=1){return new Float32Array([t,e,t+s,e,t,e+i,t,e+i,t+s,e,t+s,e+i])}}},"./libs/web-gl-display/src/sprite.ts":(t,e,s)=>{s.r(e),s.d(e,{Sprite:()=>r});var i=s("./libs/web-gl-display/src/m3x3.ts");class r{constructor(t,e,s,i,r,a,o,l,n,c,h){this.gl=t,this.shader=e,this.tileSize=s,this.worldSpaceMatrix=i,this.texture=r,this.textureBuffer=a,this.geometryBuffer=o,this.centerX=l,this.centerY=n,this.uvX=c,this.uvY=h}render(t,e,s=0,r=0){const a=this.gl;a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,this.texture),a.uniform1i(this.shader.uImageLocation,0),a.bindBuffer(a.ARRAY_BUFFER,this.textureBuffer),a.enableVertexAttribArray(this.shader.aTexCoordLocation),a.vertexAttribPointer(this.shader.aTexCoordLocation,2,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,this.geometryBuffer),a.enableVertexAttribArray(this.shader.aPositionLocation),a.vertexAttribPointer(this.shader.aPositionLocation,2,a.FLOAT,!1,0,0);const o=s*this.uvX,l=r*this.uvY,n=(new i.M3x3).transition(t*this.tileSize-this.centerX,e*this.tileSize-this.centerY);a.uniform2f(this.shader.uFrameLocation,o,l),a.uniformMatrix3fv(this.shader.uWorldLocation,!1,this.worldSpaceMatrix.getFloatArray()),a.uniformMatrix3fv(this.shader.uObjectLocation,!1,n.getFloatArray()),a.drawArrays(a.TRIANGLE_STRIP,0,6)}}},"./libs/web-gl-display/src/standard-shader.ts":(t,e,s)=>{s.r(e),s.d(e,{StandardShader:()=>r});var i=s("./libs/web-gl-display/src/generic-shader.ts");class r extends i.GenericShader{constructor(t,e,s,i,r,a,o){super(t,"\nattribute vec2 aPosition;\nattribute vec2 aTexCoord;\nvarying vec2 vTexCoord;\nuniform mat3 uWorld;\nuniform mat3 uObject;\nuniform vec2 uFrame;\nvoid main(void) {\ngl_Position = vec4(uWorld * uObject * vec3(aPosition, 1), 1);\nvTexCoord = aTexCoord + uFrame;\n}","\nprecision mediump float;\nuniform sampler2D uImage;\nvarying vec2 vTexCoord;\nvoid main(void) {\ngl_FragColor = texture2D(uImage, vTexCoord);\n}"),this.aPositionLocation=e,this.aTexCoordLocation=s,this.uImageLocation=i,this.uWorldLocation=r,this.uObjectLocation=a,this.uFrameLocation=o,this.aPositionLocation=t.getAttribLocation(this.program,"aPosition"),this.aTexCoordLocation=t.getAttribLocation(this.program,"aTexCoord"),this.uImageLocation=t.getUniformLocation(this.program,"uImage"),this.uWorldLocation=t.getUniformLocation(this.program,"uWorld"),this.uObjectLocation=t.getUniformLocation(this.program,"uObject"),this.uFrameLocation=t.getUniformLocation(this.program,"uFrame")}}},"./libs/web-gl-display/src/web-gl-display.ts":(t,e,s)=>{s.r(e),s.d(e,{WebGl2Display:()=>o});var i=s("./libs/web-gl-display/src/m3x3.ts"),r=s("./libs/web-gl-display/src/sprite-factory.ts"),a=s("./libs/web-gl-display/src/standard-shader.ts");class o{constructor(t,e,s,i=!1,o=t.getContext("webgl2"),n=new a.StandardShader(o),c=null,h=l(t.width,t.height,s),d=new r.SpriteFactory(o,n,e,h),u={},y=[],p=!1,g=[]){this.canvas=t,this.tileSize=e,this.virtualScreenHeight=s,this.alignToPixelGrid=i,this.gl=o,this.standardShader=n,this.previousProgram=c,this.worldSpaceMatrix=h,this.spriteFactory=d,this.sprites=u,this.loadingSprites=y,this.sortByDepth=p,this.spritesToDraw=g,this.gl.enable(this.gl.BLEND)}startFrame(){this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)}draw(t,e,s,i,r,a=1){this.sortByDepth?this.spritesToDraw.push(new n(t,e,s,i,r,a)):this.drawSprite(t,e,s,i,r)}endFrame(){if(this.sortByDepth){this.spritesToDraw.sort(((t,e)=>t.depth-e.depth));for(const t of this.spritesToDraw)this.drawSprite(t.sprite,t.x,t.y,t.frameX,t.frameY);this.spritesToDraw=[]}this.previousProgram=null,this.gl.useProgram(null),this.gl.flush()}drawSprite(t,e,s,i,r){const a=this.sprites[t];if(!a)return console.warn("Could not load sprite {0}",t);this.previousProgram!=a.shader.program&&(this.gl.useProgram(a.shader.program),this.previousProgram=a.shader.program),this.alignToPixelGrid&&(e=Math.floor(e*this.tileSize)/this.tileSize,s=Math.floor(s*this.tileSize)/this.tileSize),a.render(e,s,i,r)}resize(t,e){this.canvas.width=t,this.canvas.height=e,this.worldSpaceMatrix=l(t,e,this.virtualScreenHeight),this.spriteFactory=new r.SpriteFactory(this.gl,this.standardShader,this.tileSize,this.worldSpaceMatrix)}async addSprite(t,e,s=16,i=16,r=0,a=0){this.loadingSprites.push(t),this.sprites[t]=await this.spriteFactory.createSprite(e,s,i,r,a),this.loadingSprites.splice(this.loadingSprites.indexOf(t),1)}isLoading(){return this.loadingSprites.length>0}}function l(t,e,s){const r=t/(e/s);return(new i.M3x3).transition(-1,1).scale(2/r,-2/s)}class n{constructor(t,e,s,i,r,a){this.sprite=t,this.x=e,this.y=s,this.frameX=i,this.frameY=r,this.depth=a}}},"./libs/meld/src/display-config.json":t=>{t.exports=JSON.parse('{"renderToVirtualSize":false,"virtualPixelsPerTile":16,"virtualHeight":360,"wallDisplayHeight":2,"assetFolder":"assets/","inputs":{"Generate":["Escape","Enter","PadStart"],"MoveUp":["W","Up","PadUp","PadLeftStickUp"],"MoveDown":["S","Down","PadDown","PadLeftStickDown"],"MoveLeft":["A","Left","PadLeft","PadLeftStickLeft"],"MoveRight":["D","Right","PadRight","PadLeftStickRight"],"Run":["LeftShift","PadA"],"SelectNextItem":["Space"],"UseItem":["MouseLeft","PadB"]},"sprites":{"player":{"path":"base-character","width":32,"height":48,"centerX":16,"centerY":40},"default-tile-overlay-left":{"path":"default-tile-overlay-left","width":16,"height":16,"centerX":24,"centerY":8},"default-tile-overlay-right":{"path":"default-tile-overlay-right","width":16,"height":16,"centerX":-8,"centerY":8},"default-tile-overlay-top":{"path":"default-tile-overlay-top","width":16,"height":16,"centerX":8,"centerY":24},"default-tile-overlay-bottom":{"path":"default-tile-overlay-bottom","width":16,"height":16,"centerX":8,"centerY":-8},"default-wall-overlay-full-left":{"path":"default-wall-overlay-full-left","width":16,"height":32,"centerX":24,"centerY":24},"default-wall-overlay-full-right":{"path":"default-wall-overlay-full-right","width":16,"height":32,"centerX":-8,"centerY":24},"default-wall-overlay-half-left":{"path":"default-wall-overlay-half-left","width":16,"height":16,"centerX":24,"centerY":8},"default-wall-overlay-half-right":{"path":"default-wall-overlay-half-right","width":16,"height":16,"centerX":-8,"centerY":8},"default-wall-shadow-full-left":{"path":"default-wall-shadow-full-left","width":16,"height":16,"centerX":24,"centerY":8},"default-wall-shadow-full-right":{"path":"default-wall-shadow-full-right","width":16,"height":16,"centerX":-8,"centerY":8},"default-wall-shadow-half-left":{"path":"default-wall-shadow-half-left","width":16,"height":16,"centerX":24,"centerY":8},"default-wall-shadow-half-right":{"path":"default-wall-shadow-half-right","width":16,"height":16,"centerX":-8,"centerY":8},"dirt-tile":{"path":"tile-dirt","width":16,"height":16,"centerX":8,"centerY":8},"dirt-wall":{"path":"wall-dirt","width":16,"height":32,"centerX":8,"centerY":24},"earth-tile":{"path":"tile-earth","width":16,"height":16,"centerX":8,"centerY":8},"earth-wall":{"path":"wall-earth","width":16,"height":32,"centerX":8,"centerY":24},"grass-tile":{"path":"tile-grass","width":16,"height":16,"centerX":8,"centerY":8,"framesX":4,"framesY":3,"frameWeights":[1,1,1,1,1,1,1,1,10]},"grass-wall":{"path":"wall-grass","width":16,"height":32,"centerX":8,"centerY":24},"grass-tile-overlay-left":{"path":"grass-tile-overlay-left","width":16,"height":16,"centerX":24,"centerY":8},"grass-tile-overlay-right":{"path":"grass-tile-overlay-right","width":16,"height":16,"centerX":-8,"centerY":8},"grass-tile-overlay-top":{"path":"grass-tile-overlay-top","width":16,"height":16,"centerX":8,"centerY":24},"grass-tile-overlay-bottom":{"path":"grass-tile-overlay-bottom","width":16,"height":16,"centerX":8,"centerY":-8},"slab-tile":{"path":"tile-slab","width":16,"height":16,"centerX":8,"centerY":8},"slab-wall":{"path":"wall-slab","width":16,"height":32,"centerX":8,"centerY":24},"stone-tile":{"path":"tile-stone","width":16,"height":16,"centerX":8,"centerY":8},"stone-wall":{"path":"wall-stone","width":16,"height":32,"centerX":8,"centerY":24},"wooden-tile":{"path":"tile-wooden","width":16,"height":16,"centerX":8,"centerY":8},"wooden-wall":{"path":"wall-wooden","width":16,"height":32,"centerX":8,"centerY":24},"hud-life-energy":{"path":"hud-life-energy","width":26,"height":173},"hud-tool-items":{"path":"hud-tool-items","width":46,"height":166,"centerX":46}}}')},"./libs/meld/src/game-config.json":t=>{t.exports=JSON.parse('{"constants":{"playerType":"player"},"entityTypes":{"player":{"blockCollisionBehaviour":true,"circularSize":{"radius":0.625,"height":0.875},"gravityBehaviour":true,"selectedBlock":"grass"}},"solidTypes":{"dirt":{},"earth":{},"grass":{},"slab":{},"stone":{},"wooden":{}},"nonSolidTypes":{"air":{}}}')}},i={};function r(t){var e=i[t];if(void 0!==e)return e.exports;var a=i[t]={exports:{}};return s[t](a,a.exports,r),a.exports}e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,r.t=function(s,i){if(1&i&&(s=this(s)),8&i)return s;if("object"==typeof s&&s){if(4&i&&s.__esModule)return s;if(16&i&&"function"==typeof s.then)return s}var a=Object.create(null);r.r(a);var o={};t=t||[null,e({}),e([]),e(e)];for(var l=2&i&&s;"object"==typeof l&&!~t.indexOf(l);l=e(l))Object.getOwnPropertyNames(l).forEach((t=>o[t]=()=>s[t]));return o.default=()=>s,r.d(a,o),a},r.d=(t,e)=>{for(var s in e)r.o(e,s)&&!r.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var a={};return(()=>{r.r(a),r.d(a,{GameUpdate:()=>i.GameUpdate,GenerateAction:()=>i.GenerateAction,LoadState:()=>i.LoadState,Meld:()=>t.Meld,MeldDisplay:()=>e.MeldDisplay,MeldGame:()=>s.MeldGame,MovementAction:()=>i.MovementAction,PlaceBlockAction:()=>i.PlaceBlockAction,SelectNextItemAction:()=>i.SelectNextItemAction,updatesPerSecond:()=>s.updatesPerSecond});var t=r("./libs/meld/src/meld.ts"),e=r("./libs/meld/src/meld-display.ts"),s=r("./libs/meld/src/meld-game.ts"),i=r("./libs/meld/src/state/game-update.ts")})(),a})()));